"use strict";(self.webpackChunkweb_radacam=self.webpackChunkweb_radacam||[]).push([[645],{645:(et,g,s)=>{s.r(g),s.d(g,{StationModule:()=>V});var c=s(9808),d=s(8753),t=s(5e3),C=s(6675),f=s(8215),v=s(7961),r=s(2382),u=s(5330),_=s(1489),p=s(9783),x=s(845),b=s(5787),T=s(1424),S=s(3407);function w(n,a){1&n&&(t.TgZ(0,"div"),t._uU(1," *C\u1ea7n \u0111i\u1ec1n t\xean cho Tr\u1ea1m."),t.qZA())}function Z(n,a){1&n&&(t.TgZ(0,"div"),t._uU(1," *T\xean Tr\u1ea1m d\xe0i \xedt nh\u1ea5t 2 k\xfd t\u1ef1."),t.qZA())}function y(n,a){if(1&n&&(t.TgZ(0,"small",17),t.YNc(1,w,2,0,"div",18),t.YNc(2,Z,2,0,"div",18),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.formGroup.controls.name.invalid),t.xp6(1),t.Q6J("ngIf",e.formGroup.controls.name.errors.minlength)}}let E=(()=>{class n{constructor(e,i,o,l,h){this.ref=e,this.config=i,this.formBuilder=o,this.sHttpService=l,this.messageService=h,this.title="Th\xeam m\u1edbi tr\u1ea1m"}ngOnInit(){this.formGroup=this.formBuilder.group({name:["",[r.kI.required,r.kI.minLength(2)]],description:[""]})}onSubmit(){this.sHttpService.create(this.formGroup.value.name,this.formGroup.value.description).subscribe({next:e=>{200===e.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 t\u1ea1o tr\u1ea1m th\xe0nh c\xf4ng"}),this.ref.close("success")):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${e.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e.message))},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e)}})}onDestroy(){this.ref.destroy()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.E7),t.Y36(u.S),t.Y36(r.qu),t.Y36(_.P),t.Y36(p.ez))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-station"]],decls:22,vars:4,consts:[[3,"formGroup","ngSubmit"],[1,"outbound"],[1,"header","flex","align-items-center","justify-content-between","border-bottom-1","border-gray-300"],[1,"ml-2","text-xl","font-bold"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-danger","p-button-text",3,"click"],[1,"content"],[1,"p-fluid","m-2"],[1,"field","mb-2"],["for","name"],[1,"ml-2","text-red-500"],["id","name","type","text","aria-describedby","name-help","pInputText","","formControlName","name"],["id","name-help","class","text-red-500",4,"ngIf"],["for","desc"],["id","desc","rows","3","pInputTextarea","","formControlName","description"],[1,"footer","flex","align-items-center","justify-content-end","border-top-1","border-gray-300"],["pButton","","pRipple","","type","button","label","H\u1ee7y b\u1ecf","icon","fa-solid fa-times",1,"p-button-outlined","mr-1",3,"click"],["pButton","","pRipple","","type","submit","label","L\u01b0u th\xf4ng tin","icon","fa-solid fa-floppy-disk",1,"mr-1",3,"disabled"],["id","name-help",1,"text-red-500"],[4,"ngIf"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.TgZ(1,"div",1)(2,"div",2)(3,"span",3),t._uU(4),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){return i.onDestroy()}),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),t._uU(10,"T\xean Tr\u1ea1m"),t.TgZ(11,"span",9),t._uU(12,"(*)"),t.qZA()(),t._UZ(13,"input",10),t.YNc(14,y,3,2,"small",11),t.qZA(),t.TgZ(15,"div",7)(16,"label",12),t._uU(17,"M\xf4 t\u1ea3"),t.qZA(),t._UZ(18,"textarea",13),t.qZA()()(),t.TgZ(19,"div",14)(20,"button",15),t.NdJ("click",function(){return i.onDestroy()}),t.qZA(),t._UZ(21,"button",16),t.qZA()()()),2&e&&(t.Q6J("formGroup",i.formGroup),t.xp6(4),t.Oqu(i.title),t.xp6(10),t.Q6J("ngIf",i.formGroup.controls.name.invalid&&i.formGroup.controls.name.touched),t.xp6(7),t.Q6J("disabled",i.formGroup.invalid))},directives:[r._Y,r.JL,r.sg,x.Hq,b.H,r.Fj,T.o,r.JJ,r.u,c.O5,S.g],styles:[".outbound[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;overflow:hidden}.outbound[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:45px}.outbound[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;top:45px;bottom:45px;left:0;width:100%;overflow:auto}.outbound[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;bottom:0;height:45px;left:0;width:100%}"]}),n})();var A=s(5431),P=s(9269),M=s(8386),U=s(7658),m=s(8952),B=s(9955),I=s(4132),O=s(97);const H=["divBound"],J=["divTable"],R=["divPaginator"];function q(n,a){1&n&&(t.TgZ(0,"tr")(1,"th",27),t._uU(2,"#"),t.qZA(),t.TgZ(3,"th",28),t._uU(4,"T\xean "),t._UZ(5,"p-sortIcon",29),t.qZA(),t.TgZ(6,"th",30),t._uU(7,"M\xf4 t\u1ea3"),t.qZA(),t.TgZ(8,"th",31),t._uU(9,"Khu \u0111\xf4 th\u1ecb"),t.qZA(),t.TgZ(10,"th",31),t._uU(11,"Khu ch\u1ee9c n\u0103ng"),t.qZA(),t.TgZ(12,"th",32),t._uU(13,"Th\u1eddi gian t\u1ea1o "),t._UZ(14,"p-sortIcon",33),t.qZA(),t.TgZ(15,"th",34),t._uU(16,"C\u1eadp nh\u1eadt "),t._UZ(17,"p-sortIcon",35),t.qZA()())}function F(n,a){if(1&n&&(t.TgZ(0,"tr",36)(1,"td",27),t._uU(2),t.qZA(),t.TgZ(3,"td",37),t._uU(4),t.qZA(),t.TgZ(5,"td",30),t._uU(6),t.qZA(),t.TgZ(7,"td",31),t._uU(8),t.qZA(),t.TgZ(9,"td",31),t._uU(10),t.qZA(),t.TgZ(11,"td",37),t._uU(12),t.qZA(),t.TgZ(13,"td",37),t._uU(14),t.qZA()()),2&n){const e=a.$implicit,i=a.rowIndex,o=t.oxw(2);t.Q6J("pSelectableRow",e),t.xp6(2),t.Oqu((o.currentPage-1)*o.itemsPerPage+1+i),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.description),t.xp6(2),t.Oqu(e.area_name),t.xp6(2),t.Oqu(e.floc_name),t.xp6(2),t.Oqu(o.convertTime(e.created_at)),t.xp6(2),t.Oqu(o.convertTime(e.updated_at))}}function D(n,a){1&n&&(t.TgZ(0,"div",38),t._uU(1," Kh\xf4ng c\xf3 d\u1eef li\u1ec7u trong m\u1ee5c n\xe0y. "),t.qZA())}function Y(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).onAdd()}),t.qZA()}}function k(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",40),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).onEdit()}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",!e.currentStation)}}function N(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"p-splitButton",41),t.NdJ("onClick",function(){return t.CHM(e),t.oxw(2).onViewDetail()}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("showTransitionOptions","200ms")("hideTransitionOptions","200ms")("model",e.moreCommands)("disabled",!e.currentStation)}}const L=function(){return[15,20,30,50]};function Q(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",2,3),t.NdJ("resize",function(){return t.CHM(e),t.oxw().onWindowResize()},!1,t.Jf7),t.TgZ(2,"div",4),t._UZ(3,"p-breadcrumb",5),t.TgZ(4,"div",6)(5,"h3",7),t._UZ(6,"i",8),t._uU(7,"Danh s\xe1ch tr\u1ea1m "),t.qZA()(),t.TgZ(8,"div",9,10)(10,"p-table",11),t.NdJ("selectionChange",function(o){return t.CHM(e),t.oxw().currentStation=o})("onRowSelect",function(o){return t.CHM(e),t.oxw().onRowSelect(o)})("onRowUnselect",function(o){return t.CHM(e),t.oxw().onRowUnselect(o)}),t.YNc(11,q,18,0,"ng-template",12),t.YNc(12,F,15,8,"ng-template",13),t.YNc(13,D,2,0,"ng-template",14),t.qZA()()(),t.TgZ(14,"div",15,16)(16,"div",17)(17,"div",18),t.YNc(18,Y,1,0,"button",19),t.YNc(19,k,1,1,"button",20),t.YNc(20,N,1,4,"p-splitButton",21),t.qZA(),t.TgZ(21,"div",22)(22,"p-paginator",23),t.NdJ("onPageChange",function(o){return t.CHM(e),t.oxw().onPageChange(o)}),t.qZA()(),t.TgZ(23,"div",24)(24,"button",25),t.NdJ("click",function(){return t.CHM(e),t.oxw().onReSync()}),t.qZA(),t.TgZ(25,"span",26),t._uU(26),t.qZA()()()()()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("model",e.pathLinks)("home",e.homeLink),t.xp6(7),t.Q6J("selection",e.currentStation)("value",e.stations)("scrollable",!0)("loading",e.loading),t.xp6(8),t.Q6J("ngIf",e.permission.station.create),t.xp6(1),t.Q6J("ngIf",e.permission.station.edit),t.xp6(1),t.Q6J("ngIf",e.permission.station.self),t.xp6(2),t.Q6J("rows",e.itemsPerPage)("totalRecords",e.totalItems)("rowsPerPageOptions",t.DdM(17,L))("showJumpToPageDropdown",!0)("showPageLinks",!1),t.xp6(4),t.lnq("Hi\u1ec3n th\u1ecb ",(e.currentPage-1)*e.itemsPerPage+1,"-",(e.currentPage-1)*e.itemsPerPage+e.itemsPerPage>e.totalItems?e.totalItems:(e.currentPage-1)*e.itemsPerPage+e.itemsPerPage,"/",e.totalItems,"")}}function G(n,a){1&n&&(t._UZ(0,"i",49),t.TgZ(1,"span",50),t._uU(2,"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o m\u1ee5c n\xe0y!"),t.qZA())}function W(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",42)(1,"p-messages",43),t.YNc(2,G,3,0,"ng-template",44),t.qZA()(),t.TgZ(3,"div",45)(4,"div",46),t.NdJ("click",function(){return t.CHM(e),t.oxw().onGoBackHome()}),t._UZ(5,"span",47),t.TgZ(6,"span",48),t._uU(7,"Quay l\u1ea1i Trang ch\u1ee7"),t.qZA()()()}}const j=[{path:"",component:(()=>{class n{constructor(e,i,o,l,h,K,X,tt){this.sHttpService=e,this.messageService=i,this.renderer=o,this.dialogService=l,this.permissionService=h,this.router=K,this.confirmService=X,this.userService=tt,this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.stations=[],this.loading=!1}ngOnDestroy(){this.subPermission&&this.subPermission.unsubscribe(),this.loadingTime&&clearTimeout(this.loadingTime)}setStyleDiv(){this.windowWidth=this.divBound.nativeElement.offsetWidth,this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight-62}px`)}ngAfterViewInit(){this.setStyleDiv()}onWindowResize(){this.setStyleDiv()}calcWidth(){let e="";return e=this.windowWidth<576?.95*this.windowWidth+"px":this.windowWidth>=576&&this.windowWidth<768?.55*this.windowWidth+"px":this.windowWidth>=768&&this.windowWidth<992?.45*this.windowWidth+"px":this.windowWidth>=992&&this.windowWidth<1400?.4*this.windowWidth+"px":.3*this.windowWidth+"px",e}ngOnInit(){this.myAccount=this.userService.getUserFromStorage(),this.subPermission=this.permissionService.currentPermission.subscribe(e=>{e&&(this.permission=e,this.initForm(),this.fetchListOfStations())})}initForm(){this.pathLinks=[{label:"Qu\u1ea3n l\xfd",disabled:!0},{label:"Tr\u1ea1m",disabled:!0}],this.homeLink={icon:"fa-solid fa-home",routerLink:"/"},this.moreCommands=[{label:"X\xf3a b\u1ecf",icon:"fa-solid fa-minus",disabled:!0,command:()=>{this.onDelete()}}]}fetchListOfStations(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.sHttpService.getList(this.itemsPerPage,this.offset).subscribe({next:e=>{200===e.status?(this.stations=e.metadata.docs,this.totalItems=e.metadata.total,this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime),this.currentStation=void 0):2===e.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${e.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e.message),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime))},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",e),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}onPageChange(e){this.currentPage=e.page+1,this.itemsPerPage=e.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.fetchListOfStations()}onReSync(){this.fetchListOfStations()}onRowSelect(e){this.moreCommands[0].disabled=!this.permission.station.delete||!this.currentStation}onRowUnselect(e){this.moreCommands[0].disabled=!this.permission.station.delete||!this.currentStation}onAdd(){this.dialogService.open(E,{showHeader:!1,height:"365px",width:this.calcWidth(),contentStyle:{padding:"0",margin:0}}).onClose.subscribe(()=>{this.fetchListOfStations()})}onEdit(){this.dialogService.open(v.h,{data:{station:this.currentStation,title:"C\u1eadp nh\u1eadt tr\u1ea1m",editable:!0},showHeader:!1,width:"99vw",height:"99vh",contentStyle:{padding:"0",margin:0}}).onDestroy.subscribe(()=>{this.fetchListOfStations()})}onViewDetail(){this.dialogService.open(v.h,{data:{station:this.currentStation},showHeader:!1,width:"99vw",height:"99vh",contentStyle:{padding:"0",margin:0}})}onDelete(){this.confirmService.confirm({message:`B\u1ea1n c\xf3 mu\u1ed1n x\xf3a Tr\u1ea1m "${this.currentStation.name}" kh\xf4ng?`,header:"X\xe1c nh\u1eadn x\xf3a Tr\u1ea1m",icon:"pi pi-info-circle"}).then(e=>{e&&this.sHttpService.delete(this.currentStation._id).subscribe({next:i=>{200===i.status?(this.fetchListOfStations(),this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 x\xf3a Tr\u1ea1m th\xe0nh c\xf4ng"})):2===i.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${i.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i.message))},error:i=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i)}})}).catch(e=>{})}convertTime(e){return C.I.isoToVnTime(e)}onGoBackHome(){this.router.navigate(["/"])}onComeback(){localStorage.removeItem(f.o.USER),sessionStorage.removeItem(f.o.ACC),this.router.navigate(["/come-back"])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.P),t.Y36(p.ez),t.Y36(t.Qsj),t.Y36(u.xA),t.Y36(A.$),t.Y36(d.F0),t.Y36(P.I),t.Y36(M.K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-station-management"]],viewQuery:function(e,i){if(1&e&&(t.Gf(H,5,t.SBq),t.Gf(J,5,t.SBq),t.Gf(R,5,t.SBq)),2&e){let o;t.iGM(o=t.CRH())&&(i.divBound=o.first),t.iGM(o=t.CRH())&&(i.divTable=o.first),t.iGM(o=t.CRH())&&(i.divPaginator=o.first)}},decls:3,vars:2,consts:[["class","relative h-full w-full",3,"resize",4,"ngIf","ngIfElse"],["noPermission",""],[1,"relative","h-full","w-full",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["styleClass","text-sm p-1",3,"model","home"],[1,"flex","align-items-center"],[1,"text-blue-700","m-0","px-2","pt-2","pb-0"],[1,"fa-solid","fa-list","mr-2"],[1,"page-content","mt-1"],["divTable",""],["selectionMode","single","styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"selection","value","scrollable","loading","selectionChange","onRowSelect","onRowUnselect"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"absolute","bottom-0","left-0","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-5","flex","align-items-center"],["pButton","","pRipple","","type","button","label","Th\xeam","icon","fa-solid fa-plus","class","mx-1",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","label","Ch\u1ec9nh s\u1eeda","icon","fa-solid fa-pen","class","mr-1",3,"disabled","click",4,"ngIf"],["label","Chi ti\u1ebft","icon","fa-solid fa-wand-sparkles",3,"showTransitionOptions","hideTransitionOptions","model","disabled","onClick",4,"ngIf"],[1,"col-12","md:col-5","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-2","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text","m-0","p-1",3,"click"],[1,"ml-1"],[2,"width","60px","max-width","60px"],["pSortableColumn","name",2,"min-width","200px"],["field","name"],[2,"min-width","300px"],[2,"min-width","150px"],["pSortableColumn","created_at",2,"min-width","200px"],["field","created_at"],["pSortableColumn","updated_at",2,"min-width","200px"],["field","updated_at"],[3,"pSelectableRow"],[2,"min-width","200px"],[1,"p-fluid","p-2"],["pButton","","pRipple","","type","button","label","Th\xeam","icon","fa-solid fa-plus",1,"mx-1",3,"click"],["pButton","","pRipple","","type","button","label","Ch\u1ec9nh s\u1eeda","icon","fa-solid fa-pen",1,"mr-1",3,"disabled","click"],["label","Chi ti\u1ebft","icon","fa-solid fa-wand-sparkles",3,"showTransitionOptions","hideTransitionOptions","model","disabled","onClick"],[1,"flex","align-items-center","justify-content-center"],["severity","error"],["pTemplate",""],[1,"flex","align-items-center","justify-content-center","cursor-pointer"],["pRipple","",1,"flex","align-items-center","justify-content-center","w-full","h-4rem","max-w-20rem","bg-blue-500","border-round-md","shadow-8","text-white","font-bold",3,"click"],[1,"fa-solid","fa-home"],[1,"text-center","text-xl","mx-2"],[1,"pi","pi-times-circle"],[1,"ml-2"]],template:function(e,i){if(1&e&&(t.YNc(0,Q,27,18,"div",0),t.YNc(1,W,8,0,"ng-template",null,1,t.W1O)),2&e){const o=t.MAs(2);t.Q6J("ngIf",i.permission.station.self)("ngIfElse",o)}},directives:[c.O5,U.a,m.iA,p.jx,m.lQ,m.fz,m.Ei,x.Hq,b.H,B.a,I.D,O.V],styles:[""]}),n})()}];let z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[d.Bz.forChild(j)],d.Bz]}),n})();var $=s(8772);let V=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[c.ez,z,$.m]]}),n})()}}]);