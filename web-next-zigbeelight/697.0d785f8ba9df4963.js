"use strict";(self.webpackChunkweb_next_zigbeelight=self.webpackChunkweb_next_zigbeelight||[]).push([[697],{6015:(N,A,m)=>{m.d(A,{x:()=>D});var a=m(520),p=m(2340),e=m(5e3);let D=(()=>{class b{constructor(i){this.http=i}getList(i,o,t,r,c,s,E,_){let T=new a.LE;return T=T.append("device_subtype_id",i),T=T.append("limit",o),T=T.append("offset",t),null!=r&&null!=r&&(T=T.append("has_parent",r)),c&&s&&(T=T.append("time_start",c),T=T.append("time_end",s)),E&&(T=T.append("name",E)),_&&(T=T.append("address",_)),this.http.get(`${p.N.url.BASE_URL}/device`,{params:T})}createNumberOfDevices(i,o,t,r,c){let s=new a.LE;return s=s.append("device_subtype_id",i),s=s.append("count",o||1),s=s.append("prefix",t),(null!=r||null!=r)&&(null!=c||null!=c)&&(s=s.append("latitude",r),s=s.append("longitude",c)),this.http.post(`${p.N.url.BASE_URL}/device`,s)}editInfo(i){let o=new a.LE;for(const t of Object.keys(i))null!=i[t]&&null!=i[t]&&(o=o.append(t,i[t]));return this.http.put(`${p.N.url.BASE_URL}/device/${i.id}`,o)}getInfo(i){return this.http.get(`${p.N.url.BASE_URL}/device/${i}`)}getDeviceByCodeByGuest(i){return this.http.get(`${p.N.url.BASE_URL}/public/device/${i}`)}getDeviceByCode(i){let o=new a.LE;return i&&(o=o.append("device_code",i)),this.http.get(`${p.N.url.BASE_URL}/device/bycode`,{params:o})}delete(i){return this.http.delete(`${p.N.url.BASE_URL}/device/${i}`)}getDeviceInside(i,o,t){let r=new a.LE;return r=r.append("limit",o),r=r.append("offset",t),this.http.get(`${p.N.url.BASE_URL}/device/${i}/inside`,{params:r})}deleteDeviceInside(i,o){return this.http.delete(`${p.N.url.BASE_URL}/device/${i}/inside/delete/${o}`)}addDeviceInside(i,o){let t=new a.LE;return o&&0!==o.length&&o.forEach(r=>{t=t.append("device_ids[]",r)}),this.http.put(`${p.N.url.BASE_URL}/device/${i}/inside/add`,t)}getDeviceParameterAndValue(i,o){let t=new a.LE;return t=t.append("device_id",i),o&&(t=t.append("case",o)),this.http.get(`${p.N.url.BASE_URL}/device/getdevicesparameters`,{params:t})}getAllDeviceForSearchSuggest(){return this.http.get(`${p.N.url.BASE_URL}/device/data-for-search`)}getDeviceByLocation(i,o,t,r,c,s,E){let _=new a.LE;return _=_.append("lat1",i),_=_.append("lat2",t),_=_.append("long1",o),_=_.append("long2",r),_=_.append("limit",c),s&&s.length?s.forEach(T=>{_=_.append("map_ids[]",T)}):s&&0==s.length&&(_=_.append("map_ids[]",null)),E&&(_=_.append("is_displayed_on_map",E)),this.http.get(`${p.N.url.BASE_URL}/device/onmap`,{params:_})}getDeviceByLocation2(i,o,t,r,c){let s=new a.LE;return s=s.append("lat1",i),s=s.append("lat2",t),s=s.append("long1",o),s=s.append("long2",r),s=s.append("limit",c),this.http.get(`${p.N.url.BASE_URL}/device/onmap2`,{params:s})}control(i,o,t,r,c){let s=new a.LE;return o&&(s=s.append("parameter_id",o)),t&&(s=s.append("group_id",t)),r&&(s=s.append("port_id",r)),s=s.append("value",c),this.http.put(`${p.N.url.BASE_URL}/device/${i}/control`,s)}controlAll(i,o){let t=new a.LE;return t=t.append("value",o),this.http.post(`${p.N.url.BASE_URL}/device/${i}/control-cabinet-all`,t)}getEnergyNow(i){let o=new a.LE;return i&&i.length&&i.forEach(t=>{o=o.append("device_ids[]",t)}),this.http.get(`${p.N.url.BASE_URL}/power/latest`,{params:o})}clearLeakageCurrentActivated(i,o){let t=new a.LE;return t=t.append("device_id",i),t=t.append("phase",o),this.http.delete(`${p.N.url.BASE_URL}/device/cabinet/xoa-cbdr`,{params:t})}getListCabinet(){return this.http.get(`${p.N.url.BASE_URL}/device/cabinet`)}createGroupOfCabinet(i,o,t){let r=new a.LE;return r=r.append("mac",i),r=r.append("group_name",o),t&&0!==t.length&&t.forEach(c=>{r=r.append("device_ids[]",c)}),this.http.post(`${p.N.url.BASE_URL}/device/cabinet/create-group`,r)}updateGroupOfCabinet(i,o,t){let r=new a.LE;return r=r.append("mac",i),r=r.append("group_id",o),t&&0!==t.length&&t.forEach(c=>{r=r.append("device_ids[]",c)}),this.http.put(`${p.N.url.BASE_URL}/device/cabinet/group`,r)}removeGroupOfCabinet(i,o){let t=new a.LE;return t=t.append("mac",i),t=t.append("group_id",o),this.http.delete(`${p.N.url.BASE_URL}/device/cabinet/group`,{params:t})}getDeviceInsideGroup(i,o){let t=new a.LE;return t=t.append("mac",i),t=t.append("group_id",o),this.http.get(`${p.N.url.BASE_URL}/device/cabinet/group`,{params:t})}setTimeSent(i,o){let t=new a.LE;return t=t.append("timeSent",o),this.http.put(`${p.N.url.BASE_URL}/device/${i}/setTimeSent`,t)}setMac(i,o){let t=new a.LE;return t=t.append("mac",o),this.http.put(`${p.N.url.BASE_URL}/device/${i}/capNhatMacChoThietBi`,t)}configDevice(i,o,t){let r=new a.LE;if(!o||0===o.length||!t||0===t.length||o.length!=t.length)throw new Error("Danh s\xe1ch th\xf4ng s\u1ed1 c\u1ea5u h\xecnh kh\xf4ng h\u1ee3p l\u1ec7");return o.forEach(c=>{r=r.append("parameters[]",c)}),t.forEach(c=>{r=r.append("values[]",c)}),this.http.put(`${p.N.url.BASE_URL}/device/${i}/config`,r)}getDevicePowerWarningSetting(i){let o=new a.LE;return o=o.append("device_id",i),this.http.get(`${p.N.url.BASE_URL}/powerwarning`,{params:o})}createOrUpdatePowerWarningSetting(i,o,t){let r=new a.LE;return r=r.append("device_id",i),o&&(r=r.append("script_id",o)),t&&0!==t.length&&t.forEach(c=>{r=r.append("power_warning_items[]",JSON.stringify(c))}),this.http.put(`${p.N.url.BASE_URL}/powerwarning`,r)}updateDIMsForCabinet(i){return this.http.put(`${p.N.url.BASE_URL}/device/${i}/capNhatDenDimChoTu`,{})}updateDIMsForListOfCabinets(i){let o=new a.LE;if(!i||0==i.length)throw new Error("Danh s\xe1ch macs[] kh\xf4ng h\u1ee3p l\u1ec7");return i.forEach(t=>{t&&(o=o.append("mac[]",t))}),this.http.post(`${p.N.url.BASE_URL}/device/cabinet/update-list-light`,o)}createPortOfCabinet(i){let o=new a.LE;return o=o.append("device_id",i),this.http.post(`${p.N.url.BASE_URL}/device/cabinet/port`,o)}removePortOfCabinet(i,o){let t=new a.LE;return t=t.append("device_id",i),t=t.append("port_id",o),this.http.delete(`${p.N.url.BASE_URL}/device/cabinet/port`,{params:t})}settingUIWarning(i,o,t,r,c,s,E,_,T,C,S,f){let d=new a.LE;return d=d.append("v1_high",i),d=d.append("v1_low",o),d=d.append("v2_high",t),d=d.append("v2_low",r),d=d.append("v3_high",c),d=d.append("v3_low",s),d=d.append("i1_high",E),d=d.append("i2_high",_),d=d.append("i3_high",T),S&&0!==S.length&&S.forEach(g=>{d=d.append("device_ids[]",g)}),C&&(d=d.append("company_id",C)),f&&(d=d.append("device_subtype_id",f)),this.http.put(`${p.N.url.BASE_URL}/device/config/warning`,d)}getMaintenance(i,o,t,r){let c=new a.LE;return c=c.append("limit",i),c=c.append("offset",o),(null!=t||null!=t)&&(c=c.append("maintain_warning",t)),(null!=r||null!=r)&&(c=c.append("maintain_state",r)),this.http.get(`${p.N.url.BASE_URL}/device/maintain`,{params:c})}getOperationTime(i,o,t){let r=new a.LE;return o&&t&&(r=r.append("time_start",o),r=r.append("time_end",t)),i&&0!==i.length&&i.forEach(c=>{r=r.append("device_ids[]",c)}),this.http.get(`${p.N.url.BASE_URL}/log/onoff/sum`,{params:r})}getOnOff(i,o,t,r,c){let s=new a.LE;return r&&c&&(s=s.append("time_start",r),s=s.append("time_end",c)),s=s.append("limit",o),s=s.append("offset",t),i&&(s=s.append("device_id",i)),this.http.get(`${p.N.url.BASE_URL}/log/onoff`,{params:s})}toggleMaintain(i,o){let t=new a.LE;return t=t.append("maintain_state",o),i&&0!==i.length&&i.forEach(r=>{t=t.append("device_ids[]",r)}),this.http.put(`${p.N.url.BASE_URL}/device/config/maintain_state`,t)}setMaintainTime(i,o,t){let r=new a.LE;return r=r.append("maintain_time",o),t&&(r=r.append("work_time",0)),i&&0!==i.length&&i.forEach(c=>{r=r.append("device_ids[]",c)}),this.http.put(`${p.N.url.BASE_URL}/device/maintain`,r)}toggleWarning(i,o){let t=new a.LE;return t=t.append("warning_mode",o),i&&0!==i.length&&i.forEach(r=>{t=t.append("device_ids[]",r)}),this.http.put(`${p.N.url.BASE_URL}/device/config/warning_mode`,t)}}return b.\u0275fac=function(i){return new(i||b)(e.LFG(a.eN))},b.\u0275prov=e.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})()},9411:(N,A,m)=>{m.d(A,{g:()=>D});var a=m(520),p=m(2340),e=m(5e3);let D=(()=>{class b{constructor(i){this.http=i}getList(i,o,t,r,c){let s=new a.LE;return(null!=i||null!=i)&&(s=s.append("is_combination",i)),(null!=o||null!=o)&&(s=s.append("specificity",o)),s=s.append("template",t),s=s.append("limit",r),s=s.append("offset",c),this.http.get(`${p.N.url.BASE_URL}/devicetype`,{params:s})}create(i){let o=new a.LE;for(const t of Object.keys(i))null!=i[t]&&null!=i[t]&&(o=o.append(t,i[t]));return this.http.post(`${p.N.url.BASE_URL}/devicetype`,o)}edit(i,o,t,r,c,s,E){let _=new a.LE;return o&&(_=_.append("name",o)),r&&(_=_.append("count_unit",r)),t&&(_=_.append("description",t)),c&&(_=_.append("active_icon",c)),s&&(_=_.append("inactive_icon",s)),E&&(_=_.append("warning_icon",E)),this.http.put(`${p.N.url.BASE_URL}/devicetype/${i}`,_)}getDetail(i){return this.http.get(`${p.N.url.BASE_URL}/devicetype/${i}`)}delete(i){return this.http.delete(`${p.N.url.BASE_URL}/devicetype/${i}`)}uploadFile(i,o){const t=new FormData;return i&&0!==i.length&&i.forEach(r=>{t.append("image",r.file,r.filename)}),o&&0!==o.length&&o.forEach(r=>{t.append("file",r.file,r.filename)}),this.http.post(`${p.N.url.BASE_URL}/upload-image`,t)}getDeviceTypeHasParameter(i,o,t,r,c,s){let E=new a.LE;return void 0!==o&&null!=o&&(E=E.append("parameter_type",o)),void 0!==c&&null!=c&&(E=E.append("group",c)),void 0!==s&&null!=s&&(E=E.append("flag_1",s)),E=E.append("limit",t),E=E.append("offset",r),this.http.get(`${p.N.url.BASE_URL}/devicetype/${i}/parameter`,{params:E})}checkIsUsed(i){return this.http.get(`${p.N.url.BASE_URL}/devicetype/${i}/check-is-used`)}updateParameters0(i,o){let t=new a.LE;if(!o||0==o.length)throw new Error("Thi\u1ebfu danh s\xe1ch th\xf4ng s\u1ed1");return o.forEach(r=>{t=t.append("parameters[]",r)}),this.http.put(`${p.N.url.BASE_URL}/devicetype/${i}/parameter_type_0`,t)}updateParameters1(i,o){let t=new a.LE;if(!o||0==o.length)throw new Error("Thi\u1ebfu danh s\xe1ch th\xf4ng s\u1ed1");return o.forEach(r=>{t=t.append("parameters[]",r)}),this.http.put(`${p.N.url.BASE_URL}/devicetype/${i}/parameter_type_1`,t)}updateParameters2(i,o){let t=new a.LE;if(!o||0==o.length)throw new Error("Thi\u1ebfu danh s\xe1ch th\xf4ng s\u1ed1");return o.forEach(r=>{t=t.append("parameters[]",r)}),this.http.put(`${p.N.url.BASE_URL}/devicetype/${i}/add_parameter_type_1`,t)}getDeviceTree(i,o){let t=new a.LE;return t=t.append("include_device_subtype",i),t=t.append("template",o),this.http.get(`${p.N.url.BASE_URL}/devicetype/tree`,{params:t})}}return b.\u0275fac=function(i){return new(i||b)(e.LFG(a.eN))},b.\u0275prov=e.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})()},9269:(N,A,m)=>{m.d(A,{I:()=>o});var a=m(5e3),p=m(5330),e=m(9808),D=m(845),b=m(5787);let w=(()=>{class t{constructor(c,s){this.ref=c,this.config=s,this.icon="pi pi-info-circle"}ngOnInit(){this.config.data&&(this.message=this.config.data.message,this.icon=this.config.data.icon)}accept(){this.ref.close(!0)}dismiss(){this.ref.destroy()}}return t.\u0275fac=function(c){return new(c||t)(a.Y36(p.E7),a.Y36(p.S))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-confirm-dialog"]],decls:8,vars:2,consts:[[1,"diag"],[1,"outbound"],[1,"content","flex","align-items-center","p-2"],[1,"mx-3",2,"font-size","2rem",3,"ngClass"],[1,"footer","flex","align-items-center","justify-content-end"],["pButton","","pRipple","","type","button","label","H\u1ee7y b\u1ecf","icon","pi pi-times",1,"p-button-outlined","mr-1",3,"click"],["pButton","","pRipple","","type","button","label","C\xf3","icon","pi pi-check",1,"mr-1",3,"click"]],template:function(c,s){1&c&&(a.TgZ(0,"div",0)(1,"div",1)(2,"div",2),a._UZ(3,"i",3),a._uU(4),a.qZA(),a.TgZ(5,"div",4)(6,"button",5),a.NdJ("click",function(){return s.dismiss()}),a.qZA(),a.TgZ(7,"button",6),a.NdJ("click",function(){return s.accept()}),a.qZA()()()()),2&c&&(a.xp6(3),a.Q6J("ngClass",s.icon),a.xp6(1),a.hij(" ",s.message," "))},directives:[e.mk,D.Hq,b.H],styles:["@media screen and (max-width: 639.99px){.diag[_ngcontent-%COMP%]{width:99vw}}@media screen and (min-width: 640px) and (max-width: 959.99px){.diag[_ngcontent-%COMP%]{width:75vw}}@media screen and (min-width: 960px) and (max-width: 1365.99px){.diag[_ngcontent-%COMP%]{width:55vw}}@media screen and (min-width: 1366px){.diag[_ngcontent-%COMP%]{width:45vw}}.outbound[_ngcontent-%COMP%]{position:absolute;top:55px;bottom:0;left:0;right:0;overflow:hidden}.outbound[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;top:0;bottom:45px;left:0;width:100%;overflow:auto}.outbound[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;bottom:0;height:45px;left:0;width:100%}"]}),t})(),o=(()=>{class t{constructor(c){this.dialogService=c}confirm(c){return new Promise((s,E)=>{const _=this.dialogService.open(w,{header:c.header,data:{message:c.message,icon:c.icon},height:"200px",contentStyle:{padding:"0",margin:0}});_.onClose.subscribe(T=>{T&&s(T)}),_.onDestroy.subscribe(()=>E(!1))})}}return t.\u0275fac=function(c){return new(c||t)(a.LFG(p.xA))},t.\u0275prov=a.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},7697:(N,A,m)=>{m.r(A),m.d(A,{DeviceSetMaintenanceModule:()=>ce});var a=m(9808),p=m(9979),e=m(5e3),D=m(8215),b=m(2382),w=m(5330),i=m(6015),o=m(9783),t=m(845),r=m(5787),c=m(7010),s=m(1208);let E=(()=>{class l{constructor(n,u,h,M,B){this.ref=n,this.config=u,this.formBuilder=h,this.dtHttpService=M,this.messageService=B,this.title="C\xe0i \u0111\u1eb7t th\u1eddi gian b\u1ea3o d\u01b0\u1ee1ng"}ngOnInit(){this.formGroup=this.formBuilder.group({maintain_time:["",[b.kI.required]],reset_work_time:[!1]}),this.config.data&&(this.device_id=this.config.data.device_id,this.formGroup.setValue({maintain_time:this.config.data.maintain_time,reset_work_time:this.config.data.reset_work_time}))}onSubmit(){this.dtHttpService.setMaintainTime([this.device_id],this.formGroup.value.maintain_time,this.formGroup.value.reset_work_time).subscribe({next:n=>{0===n.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 c\xe0i \u0111\u1eb7t th\u1eddi gian b\u1ea3o d\u01b0\u1ee1ng th\xe0nh c\xf4ng"}),this.ref.close("success")):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${n.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",n.message))},error:n=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",n)}})}onDestroy(){this.ref.destroy()}}return l.\u0275fac=function(n){return new(n||l)(e.Y36(w.E7),e.Y36(w.S),e.Y36(b.qu),e.Y36(i.x),e.Y36(o.ez))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-edit-time"]],decls:22,vars:6,consts:[[3,"formGroup","ngSubmit"],[1,"outbound"],[1,"header","flex","align-items-center","justify-content-between","border-bottom-1","border-gray-300"],[1,"ml-2","text-xl","font-bold"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-danger","p-button-text",3,"click"],[1,"content"],[1,"p-fluid","p-2"],[1,"field","mb-3"],["for","device_type"],["formControlName","maintain_time","mode","decimal","inputId","maintain_time",3,"showButtons","min"],[1,"field-checkbox"],["formControlName","reset_work_time","inputId","binary",3,"binary"],["for","binary"],[1,"footer","flex","align-items-center","justify-content-end","border-top-1","border-gray-300"],["pButton","","pRipple","","type","button","label","H\u1ee7y b\u1ecf","icon","fa-solid fa-times",1,"p-button-outlined","mr-1",3,"click"],["pButton","","pRipple","","type","submit","label","L\u01b0u th\xf4ng tin","icon","fa-solid fa-floppy-disk",1,"mr-1",3,"disabled"]],template:function(n,u){1&n&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return u.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2)(3,"span",3),e._uU(4),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return u.onDestroy()}),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),e._uU(10,"Th\u1eddi gian b\u1ea3o tr\xec (ph\xfat)"),e.qZA(),e._UZ(11,"p-inputNumber",9),e.TgZ(12,"small")(13,"i"),e._uU(14,"*Th\u1eddi gian b\u1ea3o tr\xec l\xe0 kho\u1ea3ng th\u1eddi gian ho\u1ea1t \u0111\u1ed9ng l\u1edbn nh\u1ea5t m\xe0 thi\u1ebft b\u1ecb \u0111\xe1p \u1ee9ng y\xeau c\u1ea7u v\u1eadn h\xe0nh"),e.qZA()()(),e.TgZ(15,"div",10),e._UZ(16,"p-checkbox",11),e.TgZ(17,"label",12),e._uU(18,"Cho ph\xe9p \u0111\u1eb7t l\u1ea1i th\u1eddi gian ho\u1ea1t \u0111\u1ed9ng (reset)"),e.qZA()()()(),e.TgZ(19,"div",13)(20,"button",14),e.NdJ("click",function(){return u.onDestroy()}),e.qZA(),e._UZ(21,"button",15),e.qZA()()()),2&n&&(e.Q6J("formGroup",u.formGroup),e.xp6(4),e.Oqu(u.title),e.xp6(7),e.Q6J("showButtons",!0)("min",0),e.xp6(5),e.Q6J("binary",!0),e.xp6(5),e.Q6J("disabled",u.formGroup.invalid))},directives:[b._Y,b.JL,b.sg,t.Hq,r.H,c.Rn,b.JJ,b.u,s.XZ],styles:[".outbound[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;overflow:hidden}.outbound[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:45px}.outbound[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;top:45px;bottom:45px;left:0;width:100%;overflow:auto}.outbound[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;bottom:0;height:45px;left:0;width:100%}"]}),l})();var _=m(9269),T=m(5431),C=m(7658),S=m(4204),f=m(8054),d=m(8952),g=m(4119),x=m(4132),y=m(97);const L=["divBound"],Z=["divHeader"],P=["divContent"],U=["divTable"],O=["divPaginator"];function R(l,v){if(1&l){const n=e.EpF();e.TgZ(0,"div",17,18)(2,"app-device-tree",19),e.NdJ("onSuccess",function(h){return e.CHM(n),e.oxw(3).onSelectedNode(h)}),e.qZA()()}2&l&&(e.xp6(2),e.Q6J("treeLevel",3))}function $(l,v){1&l&&e.GkF(0)}function I(l,v){if(1&l&&(e.TgZ(0,"div",17),e.YNc(1,$,1,0,"ng-container",20),e.qZA()),2&l){e.oxw(3);const n=e.MAs(2);e.xp6(1),e.Q6J("ngTemplateOutlet",n)}}const H=function(){return{height:"100%"}},J=function(){return[20,80]},k=function(){return[15,65]};function F(l,v){if(1&l&&(e.TgZ(0,"p-splitter",15),e.YNc(1,R,3,1,"ng-template",16),e.YNc(2,I,2,1,"ng-template",16),e.qZA()),2&l){const n=e.oxw(2);e.Akn(e.DdM(5,H)),e.Q6J("panelSizes",e.DdM(6,J))("minSizes",e.DdM(7,k))("layout",n.layout)}}function Y(l,v){1&l&&e.GkF(0)}function W(l,v){if(1&l){const n=e.EpF();e.TgZ(0,"div",17)(1,"div",21,18)(3,"app-device-tree",22),e.NdJ("onSuccess",function(h){return e.CHM(n),e.oxw(2).onSelectedNode(h)}),e.qZA()(),e.YNc(4,Y,1,0,"ng-container",20),e.qZA()}if(2&l){e.oxw(2);const n=e.MAs(2);e.xp6(3),e.Q6J("treeType","option")("treeLevel",3),e.xp6(1),e.Q6J("ngTemplateOutlet",n)}}function Q(l,v){if(1&l){const n=e.EpF();e.TgZ(0,"div",3,4),e.NdJ("resize",function(){return e.CHM(n),e.oxw().onWindowResize()},!1,e.Jf7),e.TgZ(2,"div",5,6),e._UZ(4,"p-breadcrumb",7),e.TgZ(5,"div",8)(6,"h3",9),e._UZ(7,"i",10),e._uU(8,"Qu\u1ea3n l\xfd b\u1ea3o d\u01b0\u1ee1ng thi\u1ebft b\u1ecb "),e.qZA()()(),e.TgZ(9,"div",11,12),e.YNc(11,F,3,8,"p-splitter",13),e.YNc(12,W,5,3,"div",14),e.qZA()()}if(2&l){const n=e.oxw();e.xp6(4),e.Q6J("model",n.pathLinks)("home",n.homeLink),e.xp6(7),e.Q6J("ngIf","horizontal"==n.layout),e.xp6(1),e.Q6J("ngIf","vertical"==n.layout)}}function q(l,v){if(1&l){const n=e.EpF();e.TgZ(0,"div",43)(1,"input",44),e.NdJ("ngModelChange",function(h){return e.CHM(n),e.oxw(2).device_name=h}),e.qZA(),e.TgZ(2,"input",45),e.NdJ("ngModelChange",function(h){return e.CHM(n),e.oxw(2).device_address=h}),e.qZA(),e.TgZ(3,"span")(4,"button",46),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).onClear()}),e.qZA(),e.TgZ(5,"button",47),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).onSearch()}),e.qZA()()()}if(2&l){const n=e.oxw(2);e.xp6(1),e.Q6J("ngModel",n.device_name)("disabled",!n.en_search),e.xp6(1),e.Q6J("ngModel",n.device_address)("disabled",!n.en_search)}}function G(l,v){1&l&&(e.TgZ(0,"tr")(1,"th",48),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",49),e._uU(4,"T\xean "),e._UZ(5,"p-sortIcon",50),e.qZA(),e.TgZ(6,"th",51),e._uU(7,"\u0110\u1ecba ch\u1ec9"),e.qZA(),e.TgZ(8,"th",52),e._uU(9,"Th\u1eddi gian ho\u1ea1t \u0111\u1ed9ng (ph\xfat)"),e.qZA(),e.TgZ(10,"th",52),e._uU(11,"Th\u1eddi gian b\u1ea3o d\u01b0\u1ee1ng (ph\xfat)"),e.qZA(),e.TgZ(12,"th",52),e._uU(13,"Tr\u1ea1ng th\xe1i"),e.qZA(),e.TgZ(14,"th",52),e._uU(15,"C\u1ea3nh b\xe1o"),e.qZA()())}function z(l,v){1&l&&(e.TgZ(0,"span",57),e._uU(1,"B\xecnh th\u01b0\u1eddng"),e.qZA())}function K(l,v){1&l&&(e.TgZ(0,"span",58),e._uU(1,"\u0110ang b\u1ea3o d\u01b0\u1ee1ng"),e.qZA())}function j(l,v){1&l&&(e.TgZ(0,"span",57),e._uU(1,"B\xecnh th\u01b0\u1eddng"),e.qZA())}function V(l,v){1&l&&(e.TgZ(0,"span",58),e._uU(1,"C\u1ea7n b\u1ea3o d\u01b0\u1ee1ng"),e.qZA())}function X(l,v){1&l&&(e.TgZ(0,"span",59),e._uU(1,"S\u1eafp b\u1ea3o d\u01b0\u1ee1ng"),e.qZA())}function ee(l,v){if(1&l&&(e.TgZ(0,"tr",53)(1,"td",48),e._uU(2),e.qZA(),e.TgZ(3,"td",51),e._uU(4),e.qZA(),e.TgZ(5,"td",51),e._uU(6),e.qZA(),e.TgZ(7,"td",52),e._uU(8),e.qZA(),e.TgZ(9,"td",52),e._uU(10),e.qZA(),e.TgZ(11,"td",52),e.YNc(12,z,2,0,"span",54),e.YNc(13,K,2,0,"span",55),e.qZA(),e.TgZ(14,"td",52),e.YNc(15,j,2,0,"span",54),e.YNc(16,V,2,0,"span",55),e.YNc(17,X,2,0,"span",56),e.qZA()()),2&l){const n=v.$implicit,u=v.rowIndex,h=e.oxw(2);e.Q6J("pSelectableRow",n),e.xp6(2),e.Oqu((h.currentPage-1)*h.itemsPerPage+1+u),e.xp6(2),e.AsE("",n.name," (#",n.id,")"),e.xp6(2),e.Oqu(n.address),e.xp6(2),e.Oqu(n.work_time),e.xp6(2),e.Oqu(n.maintain_time),e.xp6(2),e.Q6J("ngIf",0==n.maintain_state),e.xp6(1),e.Q6J("ngIf",1==n.maintain_state),e.xp6(2),e.Q6J("ngIf",0==n.maintain_warning),e.xp6(1),e.Q6J("ngIf",1==n.maintain_warning),e.xp6(1),e.Q6J("ngIf",2==n.maintain_warning)}}function te(l,v){if(1&l&&(e.TgZ(0,"div",60),e._uU(1),e.qZA()),2&l){const n=e.oxw(2);e.xp6(1),e.hij(" Kh\xf4ng c\xf3 d\u1eef li\u1ec7u trong m\u1ee5c n\xe0y. ",n.moreInfo," ")}}const ne=function(){return[15,20,30,50]};function ie(l,v){if(1&l){const n=e.EpF();e.TgZ(0,"div",23,24)(2,"div",25),e._UZ(3,"p-breadcrumb",7),e.qZA(),e.TgZ(4,"p-table",26),e.NdJ("selectionChange",function(h){return e.CHM(n),e.oxw().currentDevice=h}),e.YNc(5,q,6,4,"ng-template",27),e.YNc(6,G,16,0,"ng-template",28),e.YNc(7,ee,18,12,"ng-template",29),e.YNc(8,te,2,1,"ng-template",30),e.qZA()(),e.TgZ(9,"div",31,32)(11,"div",33)(12,"div",34)(13,"button",35),e.NdJ("click",function(){return e.CHM(n),e.oxw().onTurnOn()}),e.qZA(),e.TgZ(14,"button",36),e.NdJ("click",function(){return e.CHM(n),e.oxw().onTurnOff()}),e.qZA(),e.TgZ(15,"button",37),e.NdJ("click",function(){return e.CHM(n),e.oxw().onEdit()}),e.qZA()(),e.TgZ(16,"div",38)(17,"p-paginator",39),e.NdJ("onPageChange",function(h){return e.CHM(n),e.oxw().onPageChange(h)}),e.qZA()(),e.TgZ(18,"div",40)(19,"button",41),e.NdJ("click",function(){return e.CHM(n),e.oxw().onReSync()}),e.qZA(),e.TgZ(20,"span",42),e._uU(21),e.qZA()()()()}if(2&l){const n=e.oxw();e.xp6(3),e.Q6J("model",n.categoryLinks)("home",n.categoryHome),e.xp6(1),e.Q6J("selection",n.currentDevice)("value",n.devices)("scrollable",!0)("loading",n.loading),e.xp6(9),e.Q6J("disabled",!n.currentDevice),e.xp6(1),e.Q6J("disabled",!n.currentDevice),e.xp6(1),e.Q6J("disabled",!n.currentDevice),e.xp6(2),e.Q6J("rows",n.itemsPerPage)("totalRecords",n.totalItems)("rowsPerPageOptions",e.DdM(17,ne))("showJumpToPageDropdown",!0)("showPageLinks",!1),e.xp6(4),e.lnq("Hi\u1ec3n th\u1ecb ",(n.currentPage-1)*n.itemsPerPage+1,"-",(n.currentPage-1)*n.itemsPerPage+n.itemsPerPage>n.totalItems?n.totalItems:(n.currentPage-1)*n.itemsPerPage+n.itemsPerPage,"/",n.totalItems,"")}}function oe(l,v){1&l&&(e._UZ(0,"i",67),e.TgZ(1,"span",68),e._uU(2,"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o m\u1ee5c n\xe0y!"),e.qZA())}function ae(l,v){if(1&l){const n=e.EpF();e.TgZ(0,"div",61)(1,"p-messages",62),e.YNc(2,oe,3,0,"ng-template",16),e.qZA()(),e.TgZ(3,"div",63)(4,"div",64),e.NdJ("click",function(){return e.CHM(n),e.oxw().onGoBackHome()}),e._UZ(5,"span",65),e.TgZ(6,"span",66),e._uU(7,"Quay l\u1ea1i Trang ch\u1ee7"),e.qZA()()()}}const re=[{path:"",component:(()=>{class l{constructor(n,u,h,M,B,pe,de){this.dHttpService=n,this.messageService=u,this.renderer=h,this.confirmService=M,this.dialogService=B,this.permissionService=pe,this.router=de,this.en_search=!1,this.moreInfo='H\xe3y ch\u1ecdn m\u1ed9t "Ph\xe2n lo\u1ea1i >> Lo\u1ea1i thi\u1ebft b\u1ecb" c\u1ee5 th\u1ec3.',this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.devices=[],this.template=!1,this.loading=!1}ngOnDestroy(){this.subPermission&&this.subPermission.unsubscribe(),this.loadingTime&&clearTimeout(this.loadingTime),this.subTreeNode&&this.subTreeNode.unsubscribe()}setStyleDiv(){this.windowWidth=this.divBound.nativeElement.offsetWidth;let n=this.divBound.nativeElement.offsetHeight,u=this.divHeader.nativeElement.offsetHeight;this.renderer.setStyle(this.divContent.nativeElement,"height",`  ${n-u}px`),setTimeout(()=>{this.windowWidth<1025?(this.layout="vertical",setTimeout(()=>{this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${n-u-this.divPaginator.nativeElement.offsetHeight-73}px`)},50)):(this.layout="horizontal",setTimeout(()=>{this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${n-u-this.divPaginator.nativeElement.offsetHeight-33}px`)},50))},50)}ngAfterViewInit(){this.setStyleDiv()}onWindowResize(){this.setStyleDiv()}calcWidth(){let n="";return n=this.windowWidth<576?.95*this.windowWidth+"px":this.windowWidth>=576&&this.windowWidth<768?.55*this.windowWidth+"px":this.windowWidth>=768&&this.windowWidth<992?.45*this.windowWidth+"px":this.windowWidth>=992&&this.windowWidth<1400?.4*this.windowWidth+"px":.3*this.windowWidth+"px",n}ngOnInit(){this.subPermission=this.permissionService.currentPermission.subscribe(n=>{n&&(this.permission=n,this.initForm())})}initForm(){this.pathLinks=[{label:"V\u1eadn h\xe0nh",disabled:!0},{label:"B\u1ea3o d\u01b0\u1ee1ng thi\u1ebft b\u1ecb",disabled:!0}],this.homeLink={icon:"fa-solid fa-home",routerLink:"/"},this.categoryHome={icon:"pi pi-home",disabled:!0}}createCategoryLink(){let n=[];n.push({label:this.treeNode.label,id:this.treeNode.data,disabled:!0});let u=this.treeNode;for(;u.parent;)n.push({label:u.parent.label,id:u.parent.data,disabled:!0}),u=u.parent;this.categoryLinks=n.reverse()}processNode(){let n=this.treeNode.data.split("@");"type"===n[0]||"device_type"===n[0]?(this.deviceSubtypeId=void 0,this.deviceSubtypeName="",this.devices=[],this.currentDevice=void 0,this.moreInfo='H\xe3y ch\u1ecdn m\u1ed9t "Ph\xe2n lo\u1ea1i >> Lo\u1ea1i thi\u1ebft b\u1ecb" c\u1ee5 th\u1ec3.',this.en_search=!1):"device_subtype"===n[0]&&(this.deviceSubtypeId=Number(n[1]),this.deviceSubtypeName=this.treeNode.label,this.currentDevice=void 0,this.fetchListOfDevices(),this.moreInfo="",this.en_search=!0)}fetchListOfDevices(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.dHttpService.getList(this.deviceSubtypeId,this.itemsPerPage,this.offset,void 0,void 0,void 0,this.device_name,this.device_address).subscribe({next:n=>{0===n.status?(this.devices=n.data.rows,this.totalItems=n.data.count,this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)):2===n.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${n.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",n.message),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime))},error:n=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",n),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}onPageChange(n){this.currentPage=n.page+1,this.itemsPerPage=n.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.fetchListOfDevices()}onReSync(){this.fetchListOfDevices()}onSelectedNode(n){this.treeNode=n,this.processNode(),this.createCategoryLink()}onGoBackHome(){this.router.navigate(["/"])}onSearch(){this.fetchListOfDevices()}onClear(){this.device_address=void 0,this.device_name=void 0}onComeback(){localStorage.removeItem(D.o.USER),sessionStorage.removeItem(D.o.ACC),this.router.navigate(["/come-back"])}getWarning(n){let u="";return 0==n?u="B\xecnh th\u01b0\u1eddng":1==n?u="C\u1ea7n b\u1ea3o d\u01b0\u1ee1ng":2==n&&(u="S\u1eafp b\u1ea3o d\u01b0\u1ee1ng"),u}getState(n){let u="";return 0==n?u="B\xecnh th\u01b0\u1eddng":1==n&&(u="\u0110ang b\u1ea3o d\u01b0\u1ee1ng"),u}onTurnOn(){this.dHttpService.toggleMaintain([this.currentDevice.id],1).subscribe({next:n=>{0===n.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 chuy\u1ec3n sang ch\u1ebf \u0111\u1ed9 b\u1ea3o d\u01b0\u1ee1ng th\xe0nh c\xf4ng!"}),this.fetchListOfDevices()):2===n.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${n.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",n.message))},error:n=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",n)}})}onTurnOff(){this.dHttpService.toggleMaintain([this.currentDevice.id],0).subscribe({next:n=>{0===n.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 t\u1eaft ch\u1ebf \u0111\u1ed9 b\u1ea3o d\u01b0\u1ee1ng th\xe0nh c\xf4ng!"}),this.fetchListOfDevices()):2===n.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${n.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",n.message))},error:n=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",n)}})}onEdit(){this.dialogService.open(E,{data:{device_id:this.currentDevice.id},showHeader:!1,height:"350px",width:this.calcWidth(),contentStyle:{padding:"0",margin:0}}).onDestroy.subscribe(()=>{this.currentDevice=void 0,this.fetchListOfDevices()})}}return l.\u0275fac=function(n){return new(n||l)(e.Y36(i.x),e.Y36(o.ez),e.Y36(e.Qsj),e.Y36(_.I),e.Y36(w.xA),e.Y36(T.$),e.Y36(p.F0))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-device-set-maintenance-management"]],viewQuery:function(n,u){if(1&n&&(e.Gf(L,5,e.SBq),e.Gf(Z,5,e.SBq),e.Gf(P,5,e.SBq),e.Gf(U,5,e.SBq),e.Gf(O,5,e.SBq)),2&n){let h;e.iGM(h=e.CRH())&&(u.divBound=h.first),e.iGM(h=e.CRH())&&(u.divHeader=h.first),e.iGM(h=e.CRH())&&(u.divContent=h.first),e.iGM(h=e.CRH())&&(u.divTable=h.first),e.iGM(h=e.CRH())&&(u.divPaginator=h.first)}},decls:5,vars:2,consts:[["class","relative h-full w-full",3,"resize",4,"ngIf","ngIfElse"],["TableConent",""],["noPermission",""],[1,"relative","h-full","w-full",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["divHeader",""],["styleClass","text-sm p-1",3,"model","home"],[1,"flex","align-items-center"],[1,"text-blue-700","m-0","px-2","pt-2","pb-2"],[1,"fa-solid","fa-list","mr-2"],[1,"absolute","bottom-0","left-0","w-full"],["divContent",""],[3,"style","panelSizes","minSizes","layout",4,"ngIf"],["class","relative h-full w-full",4,"ngIf"],[3,"panelSizes","minSizes","layout"],["pTemplate",""],[1,"relative","h-full","w-full"],["divTree",""],[3,"treeLevel","onSuccess"],[4,"ngTemplateOutlet"],[1,"p-fluid",2,"padding","2px"],[3,"treeType","treeLevel","onSuccess"],[1,"absolute","left-0","w-full"],["divTable",""],[2,"height","30px","padding","1px"],["selectionMode","single","styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"selection","value","scrollable","loading","selectionChange"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"absolute","bottom-0","left-0","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-5","flex","align-items-center"],["pButton","","pRipple","","type","button","label","B\u1eadt","icon","fa-solid fa-toggle-on",1,"mr-1",3,"disabled","click"],["pButton","","pRipple","","type","button","label","T\u1eaft","icon","fa-solid fa-toggle-off",1,"mr-1",3,"disabled","click"],["pButton","","pRipple","","type","button","label","C\xe0i \u0111\u1eb7t","icon","fa-solid fa-cog",1,"mr-1",3,"disabled","click"],[1,"col-12","md:col-5","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-2","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text","m-0","p-1",3,"click"],[1,"ml-1"],[1,"flex"],["id","src","type","text","placeholder","Nh\u1eadp t\xean thi\u1ebft b\u1ecb",1,"border-1","border-round","border-black-alpha-20","mr-2",2,"width","20rem",3,"ngModel","disabled","ngModelChange"],["id","src","type","text","placeholder","Nh\u1eadp \u0111\u1ecba ch\u1ec9",1,"border-1","border-round","border-black-alpha-20","mr-2",2,"width","20rem",3,"ngModel","disabled","ngModelChange"],["type","button","pButton","","icon","fa-solid fa-undo","pTooltip","\u0110\u1eb7t l\u1ea1i","tooltipPosition","top",1,"mr-1",3,"click"],["type","button","pButton","","icon","fa-solid fa-search","pTooltip","T\xecm ki\u1ebfm","tooltipPosition","top",3,"click"],[2,"width","60px","max-width","60px"],["pSortableColumn","name",2,"min-width","300px"],["field","name"],[2,"min-width","300px"],[2,"min-width","150px"],[3,"pSelectableRow"],["class","m-0 py-1 px-2 text-white border-round-sm bg-green-500",4,"ngIf"],["class","m-0 py-1 px-2 text-white border-round-sm bg-red-500",4,"ngIf"],["class","m-0 py-1 px-2 text-white border-round-sm bg-orange-500",4,"ngIf"],[1,"m-0","py-1","px-2","text-white","border-round-sm","bg-green-500"],[1,"m-0","py-1","px-2","text-white","border-round-sm","bg-red-500"],[1,"m-0","py-1","px-2","text-white","border-round-sm","bg-orange-500"],[1,"p-fluid","p-2"],[1,"flex","align-items-center","justify-content-center"],["severity","error"],[1,"flex","align-items-center","justify-content-center","cursor-pointer"],["pRipple","",1,"flex","align-items-center","justify-content-center","w-full","h-4rem","max-w-20rem","bg-blue-500","border-round-md","shadow-8","text-white","font-bold",3,"click"],[1,"fa-solid","fa-home"],[1,"text-center","text-xl","mx-2"],[1,"pi","pi-times-circle"],[1,"ml-2"]],template:function(n,u){if(1&n&&(e.YNc(0,Q,13,4,"div",0),e.YNc(1,ie,22,18,"ng-template",null,1,e.W1O),e.YNc(3,ae,8,0,"ng-template",null,2,e.W1O)),2&n){const h=e.MAs(4);e.Q6J("ngIf",u.permission.menu.operation_set_maintenance)("ngIfElse",h)}},directives:[a.O5,C.a,S.q,o.jx,f.a,a.tP,d.iA,b.Fj,b.JJ,b.On,t.Hq,g.u,d.lQ,d.fz,d.Ei,r.H,x.D,y.V],styles:["#src[_ngcontent-%COMP%]:focus{outline:none!important;border-color:#719ece;box-shadow:0 0 10px #719ece}"]}),l})()}];let se=(()=>{class l{}return l.\u0275fac=function(n){return new(n||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[[p.Bz.forChild(re)],p.Bz]}),l})();var le=m(4695);let ce=(()=>{class l{}return l.\u0275fac=function(n){return new(n||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[[a.ez,se,le.m]]}),l})()},8054:(N,A,m)=>{m.d(A,{a:()=>T});var a=m(5e3),p=m(8215),e=m(9411),D=m(9783),b=m(9979),w=m(9808),i=m(2629),o=m(1818),t=m(2382);function r(C,S){1&C&&(a.TgZ(0,"span",5),a._uU(1,"Danh m\u1ee5c"),a.qZA())}function c(C,S){1&C&&(a.TgZ(0,"span",5),a._uU(1,"Kh\xf4ng c\xf3 danh m\u1ee5c"),a.qZA())}const s=function(){return{margin:0,padding:"2px"}};function E(C,S){if(1&C){const f=a.EpF();a.TgZ(0,"p-tree",2),a.NdJ("selectionChange",function(g){return a.CHM(f),a.oxw().selectedNodes=g})("onNodeSelect",function(g){return a.CHM(f),a.oxw().nodeSelect(g)}),a.YNc(1,r,2,0,"ng-template",3),a.YNc(2,c,2,0,"ng-template",4),a.qZA()}if(2&C){const f=a.oxw();a.Akn(a.DdM(5,s)),a.Q6J("value",f.treeNodes)("selection",f.selectedNodes)("loading",f.loading)}}function _(C,S){if(1&C){const f=a.EpF();a.TgZ(0,"p-treeSelect",6),a.NdJ("ngModelChange",function(g){return a.CHM(f),a.oxw().selectedNodes=g})("onNodeSelect",function(g){return a.CHM(f),a.oxw().nodeSelect(g)}),a.qZA()}if(2&C){const f=a.oxw();a.Akn(a.DdM(5,s)),a.Q6J("ngModel",f.selectedNodes)("options",f.treeNodes)("scrollHeight","200px")}}let T=(()=>{class C{constructor(f,d,g){this.dtHttpService=f,this.messageService=d,this.router=g,this.treeType="tree",this.treeLevel=3,this.template=!1,this.include_device_subtype=!1,this.disabled_nodes=[],this.reload=!1,this.onSuccess=new a.vpe,this.loading=!1}ngOnDestroy(){this.loadingTime&&clearTimeout(this.loadingTime)}ngOnChanges(f){let d=f.reload;d&&d.currentValue&&(this.fetchTreeData(),this.reload=!1)}ngOnInit(){this.fetchTreeData()}fetchTreeData(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.dtHttpService.getDeviceTree(this.include_device_subtype,this.template).subscribe({next:f=>{0===f.status?(this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime),this.createNode1(f.data)):2===f.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${f.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",f.message),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime))},error:f=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",f),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}createNode1(f){this.treeNodes=[],f.forEach(d=>{let g={};"Thi\u1ebft b\u1ecb"===d.name?(g.label=d.name,g.data="type@0",g.key=g.data,g.expandedIcon="pi pi-folder-open",g.collapsedIcon="pi pi-folder",g.children=[],g.selectable=!this.disabled_nodes.find(x=>g.key==x),d.items&&this.treeLevel>=2&&g.children.push(...this.createNode2(d.items,g.selectable))):"Thi\u1ebft b\u1ecb t\u1ed5ng h\u1ee3p"===d.name&&(g.label=d.name,g.data="type@1",g.key=g.data,g.expandedIcon="pi pi-folder-open",g.collapsedIcon="pi pi-folder",g.children=[],g.selectable=!this.disabled_nodes.find(x=>g.key==x),d.items&&g.children.push(...this.createNode2(d.items,g.selectable))),0!==Object.keys(g).length&&this.treeNodes.push(g)})}createNode2(f,d){let g=[];return f.forEach(x=>{let y={};y.label=x.name,y.data=`device_type@${x.id}`,y.key=y.data,y.expandedIcon="pi pi-folder-open",y.collapsedIcon="pi pi-folder",y.children=[],y.selectable=d&&!this.disabled_nodes.find(L=>y.key==L),x.device_subtypes&&this.treeLevel>=3&&y.children.push(...this.createNode3(x.device_subtypes,y.selectable)),g.push(y)}),g}createNode3(f,d){let g=[];return f.forEach(x=>{let y={};y.label=x.name,y.data=`device_subtype@${x.id}`,y.key=y.data,y.expandedIcon="pi pi-folder-open",y.collapsedIcon="pi pi-folder",y.selectable=d&&!this.disabled_nodes.find(L=>y.key==L),g.push(y)}),g}nodeSelect(f){this.onSuccess.emit(f.node)}onComeback(){localStorage.removeItem(p.o.USER),sessionStorage.removeItem(p.o.ACC),this.router.navigate(["/come-back"])}}return C.\u0275fac=function(f){return new(f||C)(a.Y36(e.g),a.Y36(D.ez),a.Y36(b.F0))},C.\u0275cmp=a.Xpm({type:C,selectors:[["app-device-tree"]],inputs:{treeType:"treeType",treeLevel:"treeLevel",template:"template",include_device_subtype:"include_device_subtype",disabled_nodes:"disabled_nodes",reload:"reload"},outputs:{onSuccess:"onSuccess"},features:[a.TTD],decls:2,vars:2,consts:[["selectionMode","single","scrollHeight","flex",3,"value","selection","loading","style","selectionChange","onNodeSelect",4,"ngIf"],["selectionMode","single","placeholder","Duy\u1ec7t danh m\u1ee5c","emptyMessage","Kh\xf4ng c\xf3 danh m\u1ee5c","class","p-0","panelClass","h-2rem overflow-auto",3,"ngModel","options","scrollHeight","style","ngModelChange","onNodeSelect",4,"ngIf"],["selectionMode","single","scrollHeight","flex",3,"value","selection","loading","selectionChange","onNodeSelect"],["pTemplate","header"],["pTemplate","empty"],[1,"font-bold","ml-2"],["selectionMode","single","placeholder","Duy\u1ec7t danh m\u1ee5c","emptyMessage","Kh\xf4ng c\xf3 danh m\u1ee5c","panelClass","h-2rem overflow-auto",1,"p-0",3,"ngModel","options","scrollHeight","ngModelChange","onNodeSelect"]],template:function(f,d){1&f&&(a.YNc(0,E,3,6,"p-tree",0),a.YNc(1,_,1,6,"p-treeSelect",1)),2&f&&(a.Q6J("ngIf","tree"==d.treeType),a.xp6(1),a.Q6J("ngIf","option"==d.treeType))},directives:[w.O5,i.mp,D.jx,o.mP,t.JJ,t.On],styles:[""]}),C})()}}]);