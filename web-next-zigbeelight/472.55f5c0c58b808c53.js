"use strict";(self.webpackChunkweb_next_zigbeelight=self.webpackChunkweb_next_zigbeelight||[]).push([[472],{7472:(Se,P,r)=>{r.r(P),r.d(P,{DeviceTypeModule:()=>Ie});var m=r(9808),v=r(9979),e=r(5e3),C=r(6675),x=r(5431),u=r(5330),f=r(845),_=r(5787),I=r(3542),h=r(8215),y=r(2340),T=r(9411),d=r(9783),g=r(8952),Z=r(4132);const w=["divBound"],S=["divTable"],U=["divPaginator"];function q(n,o){1&n&&(e.TgZ(0,"tr")(1,"th",16),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",17),e._uU(4,"\u0110\u1eb7c t\xednh"),e.qZA(),e.TgZ(5,"th",17),e._uU(6,"Chi ti\u1ebft"),e.qZA()())}function H(n,o){if(1&n&&(e.TgZ(0,"span"),e._UZ(1,"img",19),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw();e.xp6(1),e.Q6J("src",i.getIcons(t.value),e.LSH)}}function M(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.value," ")}}function k(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",16),e._uU(2),e.qZA(),e.TgZ(3,"td",17),e._uU(4),e.qZA(),e.TgZ(5,"td",17),e.YNc(6,H,2,1,"span",18),e.YNc(7,M,2,1,"span",18),e.qZA()()),2&n){const t=o.$implicit,i=o.rowIndex;e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.key),e.xp6(2),e.Q6J("ngIf","Icon ho\u1ea1t \u0111\u1ed9ng"==t.key||"Icon kh\xf4ng ho\u1ea1t \u0111\u1ed9ng"==t.key||"Icon c\u1ea3nh b\xe1o"==t.key),e.xp6(1),e.Q6J("ngIf","Icon ho\u1ea1t \u0111\u1ed9ng"!==t.key&&"Icon kh\xf4ng ho\u1ea1t \u0111\u1ed9ng"!==t.key&&"Icon c\u1ea3nh b\xe1o"!==t.key)}}const O=function(){return[15,20,30,50]};let B=(()=>{class n{constructor(t,i,s,a){this.dtHttpService=t,this.messageService=i,this.renderer=s,this.router=a,this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.characteristics=[],this.loading=!1}ngOnDestroy(){this.loadingTime&&clearTimeout(this.loadingTime)}ngOnInit(){this.deviceType&&this.fetchDeviceTypeInfo()}ngAfterViewChecked(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight}px`)}onPageChange(t){this.currentPage=t.page+1,this.itemsPerPage=t.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.fetchDeviceTypeInfo()}onReSync(){this.fetchDeviceTypeInfo()}convertTime(t){return C.I.isoToVnTime(t)}getIcons(t){return y.N.url.BASE_IMG+t}fetchDeviceTypeInfo(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.dtHttpService.getDetail(this.deviceType.id).subscribe({next:t=>{0===t.status?(this.deviceType=t.data,this.getCharacteristics(),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)):2===t.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${t.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t.message),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime))},error:t=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}getCharacteristics(){this.totalItems=0;for(const t in this.deviceType)"name"==t?(this.characteristics[this.totalItems]={key:"T\xean",value:this.deviceType[t]},this.totalItems+=1):"description"==t?(this.characteristics[this.totalItems]={key:"M\xf4 t\u1ea3",value:this.deviceType[t]},this.totalItems+=1):"count_unit"==t?(this.characteristics[this.totalItems]={key:"\u0110\u01a1n v\u1ecb",value:this.deviceType[t]},this.totalItems+=1):"is_combination_name"==t?(this.characteristics[this.totalItems]={key:"Lo\u1ea1i",value:this.deviceType[t]},this.totalItems+=1):"active_icon"==t?(this.characteristics[this.totalItems]={key:"Icon ho\u1ea1t \u0111\u1ed9ng",value:this.deviceType[t]},this.totalItems+=1):"inactive_icon"==t?(this.characteristics[this.totalItems]={key:"Icon kh\xf4ng ho\u1ea1t \u0111\u1ed9ng",value:this.deviceType[t]},this.totalItems+=1):"warning_icon"==t?(this.characteristics[this.totalItems]={key:"Icon c\u1ea3nh b\xe1o",value:this.deviceType[t]},this.totalItems+=1):"createdAt"==t?(this.characteristics[this.totalItems]={key:"Th\u1eddi gian t\u1ea1o",value:this.convertTime(this.deviceType[t])},this.totalItems+=1):"updatedAt"==t&&(this.characteristics[this.totalItems]={key:"C\u1eadp nh\u1eadt",value:this.convertTime(this.deviceType[t])},this.totalItems+=1)}onComeback(){localStorage.removeItem(h.o.USER),sessionStorage.removeItem(h.o.ACC),this.router.navigate(["/come-back"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T.g),e.Y36(d.ez),e.Y36(e.Qsj),e.Y36(v.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-device-type-info"]],viewQuery:function(t,i){if(1&t&&(e.Gf(w,5,e.SBq),e.Gf(S,5,e.SBq),e.Gf(U,5,e.SBq)),2&t){let s;e.iGM(s=e.CRH())&&(i.divBound=s.first),e.iGM(s=e.CRH())&&(i.divTable=s.first),e.iGM(s=e.CRH())&&(i.divPaginator=s.first)}},inputs:{deviceType:"deviceType"},decls:17,vars:12,consts:[[1,"absolute","top-0","left-0","bottom-0","right-0"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["divTable",""],["styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"value","loading","scrollable"],["pTemplate","header"],["pTemplate","body"],[1,"absolute","bottom-0","left-0","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-1","flex","align-items-center"],[1,"col-12","md:col-8","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-3","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text","m-0","p-1",3,"click"],[1,"ml-1"],[2,"width","60px","max-width","60px"],[2,"min-width","200px"],[4,"ngIf"],[2,"max-width","24px",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0,1)(2,"div",2,3)(4,"p-table",4),e.YNc(5,q,7,0,"ng-template",5),e.YNc(6,k,8,4,"ng-template",6),e.qZA()(),e.TgZ(7,"div",7,8)(9,"div",9),e._UZ(10,"div",10),e.TgZ(11,"div",11)(12,"p-paginator",12),e.NdJ("onPageChange",function(a){return i.onPageChange(a)}),e.qZA()(),e.TgZ(13,"div",13)(14,"button",14),e.NdJ("click",function(){return i.onReSync()}),e.qZA(),e.TgZ(15,"span",15),e._uU(16),e.qZA()()()()()),2&t&&(e.xp6(4),e.Q6J("value",i.characteristics)("loading",i.loading)("scrollable",!0),e.xp6(8),e.Q6J("rows",i.itemsPerPage)("totalRecords",i.totalItems)("rowsPerPageOptions",e.DdM(11,O))("showJumpToPageDropdown",!0)("showPageLinks",!1),e.xp6(4),e.lnq("Hi\u1ec3n th\u1ecb ",(i.currentPage-1)*i.itemsPerPage+1,"-",(i.currentPage-1)*i.itemsPerPage+i.itemsPerPage>i.totalItems?i.totalItems:(i.currentPage-1)*i.itemsPerPage+i.itemsPerPage,"/",i.totalItems,""))},directives:[g.iA,d.jx,m.O5,Z.D,f.Hq,_.H],styles:[""]}),n})();var J=r(1316);const L=["divBound"],R=["divTable"],N=["divPaginator"];function F(n,o){1&n&&(e.TgZ(0,"tr")(1,"th",17),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",18),e._uU(4,"T\xean"),e.qZA(),e.TgZ(5,"th",18),e._uU(6,"M\xf4 t\u1ea3"),e.qZA(),e.TgZ(7,"th",19),e._uU(8,"\u0110\u01a1n v\u1ecb"),e.qZA()())}function Y(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",17),e._uU(2),e.qZA(),e.TgZ(3,"td",18),e._uU(4),e.qZA(),e.TgZ(5,"td",18),e._uU(6),e.qZA(),e.TgZ(7,"td",19),e._uU(8),e.qZA()()),2&n){const t=o.$implicit,i=o.rowIndex;e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.parameter.name),e.xp6(2),e.Oqu(t.parameter.description),e.xp6(2),e.Oqu(t.parameter.unit)}}function Q(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().onEdit()}),e.qZA()}}const G=function(){return[15,20,30,50]};let W=(()=>{class n{constructor(t,i,s,a,c,l){this.dtHttpService=t,this.messageService=i,this.renderer=s,this.permissionService=a,this.dialogService=c,this.router=l,this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.parameter_type=0,this.deviceTypeHasParameters=[],this.loading=!1}ngOnDestroy(){this.subPermission&&this.subPermission.unsubscribe(),this.loadingTime&&clearTimeout(this.loadingTime)}ngOnInit(){this.deviceType&&(this.fetchListOfParameters(),this.checkIsUsed()),this.subPermission=this.permissionService.currentPermission.subscribe(t=>{t&&(this.permission=t)})}ngAfterViewChecked(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight}px`)}onPageChange(t){this.currentPage=t.page+1,this.itemsPerPage=t.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.fetchListOfParameters()}onReSync(){this.fetchListOfParameters()}convertTime(t){return C.I.isoToVnTime(t)}getIcons(t){return y.N.url.BASE_IMG+t}fetchListOfParameters(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.dtHttpService.getDeviceTypeHasParameter(this.deviceType.id,this.parameter_type,this.itemsPerPage,this.offset,void 0,void 0).subscribe({next:t=>{0===t.status?(this.deviceTypeHasParameters=t.data.rows,this.totalItems=t.data.count,this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)):2===t.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${t.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t.message),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime))},error:t=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}checkIsUsed(){this.dtHttpService.checkIsUsed(this.deviceType.id).subscribe({next:t=>{0===t.status?this.deviceTypeIsUsed=t.data:(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${t.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t.message))},error:t=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t)}})}onEdit(){let t=[];this.deviceTypeHasParameters.forEach(s=>{t.push(s.parameter)}),this.dialogService.open(J.n,{data:{parameterIns:t,deviceTypeIsUsed:this.deviceTypeIsUsed,parameter_type:this.parameter_type},showHeader:!1,width:"99vw",height:"99vh",contentStyle:{padding:"0",margin:0}}).onClose.subscribe(s=>{if(s){let a=[];s.forEach(c=>{a.push(c.id)}),0==this.parameter_type?this.updateParameter0(a):this.deviceTypeIsUsed||1!=this.parameter_type?this.deviceTypeIsUsed&&1==this.parameter_type&&this.updateParameter2(a):this.updateParameter1(a)}})}updateParameter0(t){this.dtHttpService.updateParameters0(this.deviceType.id,t).subscribe({next:i=>{0===i.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"C\u1eadp nh\u1eadt danh s\xe1ch th\xf4ng s\u1ed1 th\xe0nh c\xf4ng"}),this.fetchListOfParameters()):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${i.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i.message))},error:i=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i)}})}updateParameter1(t){this.dtHttpService.updateParameters1(this.deviceType.id,t).subscribe({next:i=>{0===i.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"C\u1eadp nh\u1eadt danh s\xe1ch th\xf4ng s\u1ed1 th\xe0nh c\xf4ng"}),this.fetchListOfParameters()):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${i.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i.message))},error:i=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i)}})}updateParameter2(t){this.dtHttpService.updateParameters2(this.deviceType.id,t).subscribe({next:i=>{0===i.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"C\u1eadp nh\u1eadt danh s\xe1ch th\xf4ng s\u1ed1 th\xe0nh c\xf4ng"}),this.fetchListOfParameters()):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${i.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i.message))},error:i=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i)}})}onComeback(){localStorage.removeItem(h.o.USER),sessionStorage.removeItem(h.o.ACC),this.router.navigate(["/come-back"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T.g),e.Y36(d.ez),e.Y36(e.Qsj),e.Y36(x.$),e.Y36(u.xA),e.Y36(v.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-device-type-parameter"]],viewQuery:function(t,i){if(1&t&&(e.Gf(L,5,e.SBq),e.Gf(R,5,e.SBq),e.Gf(N,5,e.SBq)),2&t){let s;e.iGM(s=e.CRH())&&(i.divBound=s.first),e.iGM(s=e.CRH())&&(i.divTable=s.first),e.iGM(s=e.CRH())&&(i.divPaginator=s.first)}},inputs:{deviceType:"deviceType",parameter_type:"parameter_type"},decls:18,vars:13,consts:[[1,"absolute","top-0","left-0","bottom-0","right-0"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["divTable",""],["styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"value","loading","scrollable"],["pTemplate","header"],["pTemplate","body"],[1,"absolute","bottom-0","left-0","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-2","flex","align-items-center"],["pButton","","pRipple","","type","button","label","Ch\u1ec9nh s\u1eeda","icon","fa-solid fa-pen","class","mx-1",3,"click",4,"ngIf"],[1,"col-12","md:col-7","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-3","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text","m-0","p-1",3,"click"],[1,"ml-1"],[2,"width","60px","max-width","60px"],[2,"min-width","300px"],[2,"min-width","100px"],["pButton","","pRipple","","type","button","label","Ch\u1ec9nh s\u1eeda","icon","fa-solid fa-pen",1,"mx-1",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0,1)(2,"div",2,3)(4,"p-table",4),e.YNc(5,F,9,0,"ng-template",5),e.YNc(6,Y,9,4,"ng-template",6),e.qZA()(),e.TgZ(7,"div",7,8)(9,"div",9)(10,"div",10),e.YNc(11,Q,1,0,"button",11),e.qZA(),e.TgZ(12,"div",12)(13,"p-paginator",13),e.NdJ("onPageChange",function(a){return i.onPageChange(a)}),e.qZA()(),e.TgZ(14,"div",14)(15,"button",15),e.NdJ("click",function(){return i.onReSync()}),e.qZA(),e.TgZ(16,"span",16),e._uU(17),e.qZA()()()()()),2&t&&(e.xp6(4),e.Q6J("value",i.deviceTypeHasParameters)("loading",i.loading)("scrollable",!0),e.xp6(7),e.Q6J("ngIf",i.permission.device_type.edit),e.xp6(2),e.Q6J("rows",i.itemsPerPage)("totalRecords",i.totalItems)("rowsPerPageOptions",e.DdM(12,G))("showJumpToPageDropdown",!0)("showPageLinks",!1),e.xp6(4),e.lnq("Hi\u1ec3n th\u1ecb ",(i.currentPage-1)*i.itemsPerPage+1,"-",(i.currentPage-1)*i.itemsPerPage+i.itemsPerPage>i.totalItems?i.totalItems:(i.currentPage-1)*i.itemsPerPage+i.itemsPerPage,"/",i.totalItems,""))},directives:[g.iA,d.jx,m.O5,f.Hq,_.H,Z.D],styles:[""]}),n})();var A=r(97);const $=["divBound"],j=["divHeader"],z=["divTable"];function V(n,o){if(1&n&&e._UZ(0,"app-device-type-info",14),2&n){const t=e.oxw(2);e.Q6J("deviceType",t.deviceType)}}function X(n,o){if(1&n&&e._UZ(0,"app-device-type-parameter",15),2&n){const t=e.oxw(2);e.Q6J("deviceType",t.deviceType)("parameter_type",0)}}function K(n,o){if(1&n&&e._UZ(0,"app-device-type-parameter",15),2&n){const t=e.oxw(2);e.Q6J("deviceType",t.deviceType)("parameter_type",1)}}function ee(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",2,3),e.NdJ("resize",function(){return e.CHM(t),e.oxw().onWindowResize()},!1,e.Jf7),e.TgZ(2,"div",4,5)(4,"div",6)(5,"span",7),e._uU(6),e.qZA(),e.TgZ(7,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().onDestroy()}),e.qZA()(),e._UZ(8,"p-tabMenu",9),e.qZA(),e.TgZ(9,"div",10,11),e.YNc(11,V,1,1,"app-device-type-info",12),e.YNc(12,X,1,2,"app-device-type-parameter",13),e.YNc(13,K,1,2,"app-device-type-parameter",13),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(6),e.Oqu(t.title),e.xp6(2),e.Q6J("model",t.tabs)("activeItem",t.activeTab),e.xp6(3),e.Q6J("ngIf",1==t.tabIndex),e.xp6(1),e.Q6J("ngIf",2==t.tabIndex),e.xp6(1),e.Q6J("ngIf",3==t.tabIndex)}}function te(n,o){1&n&&(e._UZ(0,"i",18),e.TgZ(1,"span",19),e._uU(2,"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o m\u1ee5c n\xe0y!"),e.qZA())}function ie(n,o){1&n&&(e.TgZ(0,"p-messages",16),e.YNc(1,te,3,0,"ng-template",17),e.qZA())}let ne=(()=>{class n{constructor(t,i,s,a){this.renderer=t,this.permissionService=i,this.ref=s,this.config=a,this.tabIndex=1,this.title="Chi ti\u1ebft Ph\xe2n lo\u1ea1i"}ngOnDestroy(){this.subPermission&&this.subPermission.unsubscribe()}setStyleDiv(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divHeader.nativeElement.offsetHeight}px`)}ngAfterViewInit(){this.setStyleDiv()}onWindowResize(){this.setStyleDiv()}ngOnInit(){this.subPermission=this.permissionService.currentPermission.subscribe(t=>{t&&(this.permission=t,this.initForm(),this.config.data&&(this.deviceType=this.config.data.deviceType))})}initForm(){this.tabs=[{label:"Th\xf4ng tin chung",command:()=>{this.tabIndex=1}},{label:"Th\xf4ng s\u1ed1 K\u1ef9 thu\u1eadt",command:()=>{this.tabIndex=2}},{label:"Th\xf4ng s\u1ed1 V\u1eadn h\xe0nh",command:()=>{this.tabIndex=3}}],this.activeTab=this.tabs[0],this.tabIndex=1}onDestroy(){this.ref.destroy()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Qsj),e.Y36(x.$),e.Y36(u.E7),e.Y36(u.S))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-device-type-detail"]],viewQuery:function(t,i){if(1&t&&(e.Gf($,5,e.SBq),e.Gf(j,5,e.SBq),e.Gf(z,5,e.SBq)),2&t){let s;e.iGM(s=e.CRH())&&(i.divBound=s.first),e.iGM(s=e.CRH())&&(i.divHeader=s.first),e.iGM(s=e.CRH())&&(i.divTable=s.first)}},decls:3,vars:2,consts:[["class","absolute top-0 left-0 bottom-0 right-0",3,"resize",4,"ngIf","ngIfElse"],["noPermission",""],[1,"absolute","top-0","left-0","bottom-0","right-0",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["divHeader",""],[1,"flex","align-items-center","justify-content-between","border-bottom-1","border-gray-300"],[1,"ml-2","text-xl","font-bold"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-danger","p-button-text",3,"click"],[3,"model","activeItem"],[1,"absolute","bottom-0","left-0","w-full"],["divTable",""],[3,"deviceType",4,"ngIf"],[3,"deviceType","parameter_type",4,"ngIf"],[3,"deviceType"],[3,"deviceType","parameter_type"],["severity","error"],["pTemplate",""],[1,"pi","pi-times-circle"],[1,"ml-2"]],template:function(t,i){if(1&t&&(e.YNc(0,ee,14,6,"div",0),e.YNc(1,ie,2,0,"ng-template",null,1,e.W1O)),2&t){const s=e.MAs(2);e.Q6J("ngIf",i.permission.device_type.self)("ngIfElse",s)}},directives:[m.O5,f.Hq,_.H,I.d,B,W,A.V,d.jx],styles:[""]}),n})();var D=r(5861),p=r(2382),b=r(4464),se=r(1424),oe=r(3407),ae=r(4036);function re(n,o){1&n&&(e.TgZ(0,"div"),e._uU(1," *C\u1ea7n \u0111i\u1ec1n t\xean cho Ph\xe2n lo\u1ea1i."),e.qZA())}function ce(n,o){1&n&&(e.TgZ(0,"div"),e._uU(1," *T\xean Ph\xe2n lo\u1ea1i d\xe0i \xedt nh\u1ea5t 2 k\xfd t\u1ef1."),e.qZA())}function le(n,o){if(1&n&&(e.TgZ(0,"small",32),e.YNc(1,re,2,0,"div",33),e.YNc(2,ce,2,0,"div",33),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.formGroup.controls.name.invalid),e.xp6(1),e.Q6J("ngIf",t.formGroup.controls.name.errors.minlength)}}let E=(()=>{class n{constructor(t,i,s,a,c){this.ref=t,this.config=i,this.formBuilder=s,this.dtHttpService=a,this.messageService=c,this.title="Th\xeam m\u1edbi Ph\xe2n lo\u1ea1i",this.iconActiveUrl="assets/other/ban-24-r.png",this.iconInActiveUrl="assets/other/ban-24-r.png",this.iconWarningUrl="assets/other/ban-24-r.png",this.isCombination=[{name:"Thi\u1ebft b\u1ecb",value:0},{name:"Thi\u1ebft b\u1ecb t\u1ed5ng h\u1ee3p",value:1}]}ngOnInit(){this.formGroup=this.formBuilder.group({name:["",[p.kI.required,p.kI.minLength(2)]],description:[""],count_unit:[""],is_combination:[{name:"Thi\u1ebft b\u1ecb",value:0},[p.kI.required]]}),this.config.data&&(this.deviceType=this.config.data.deviceType,this.title=this.config.data.title,this.formGroup.setValue({name:this.deviceType.name,description:this.deviceType.description,count_unit:this.deviceType.count_unit,is_combination:0==this.deviceType.is_combination?{name:"Thi\u1ebft b\u1ecb",value:0}:{name:"Thi\u1ebft b\u1ecb t\u1ed5ng h\u1ee3p",value:1}}),this.deviceType.active_icon&&(this.iconActiveUrl=y.N.url.BASE_IMG+this.deviceType.active_icon),this.deviceType.inactive_icon&&(this.iconInActiveUrl=y.N.url.BASE_IMG+this.deviceType.inactive_icon),this.deviceType.warning_icon&&(this.iconWarningUrl=y.N.url.BASE_IMG+this.deviceType.warning_icon))}onFileIconActiveSelect(t){if(t.target.files.length>0){this.fileIconActive=t.target.files[0];const i=new FileReader;i.onload=s=>this.iconActiveUrl=i.result,i.readAsDataURL(t.target.files[0])}}onFileIconInActiveSelect(t){if(t.target.files.length>0){this.fileIconInActive=t.target.files[0];const i=new FileReader;i.onload=s=>this.iconInActiveUrl=i.result,i.readAsDataURL(t.target.files[0])}}onFileWarningSelect(t){if(t.target.files.length>0){this.fileIconWarning=t.target.files[0];const i=new FileReader;i.onload=s=>this.iconWarningUrl=i.result,i.readAsDataURL(t.target.files[0])}}getNameFile(t){return t?t.name:"Ch\u1ecdn file..."}onSubmit(){let t=[];this.fileIconActive&&t.push({file:this.fileIconActive,filename:"active"}),this.fileIconInActive&&t.push({file:this.fileIconInActive,filename:"inactive"}),this.fileIconWarning&&t.push({file:this.fileIconWarning,filename:"warning"});let i={name:this.formGroup.value.name,count_unit:this.formGroup.value.count_unit,description:this.formGroup.value.description,is_combination:this.formGroup.value.is_combination.value,specificity:2};this.deviceType?this.onEdit(t,i):this.onAdd(t,i)}onAdd(t,i){var s=this;return(0,D.Z)(function*(){if(t&&0!==t.length)try{const a=yield(0,b.n)(s.dtHttpService.uploadFile(t,void 0));if(0!==a.status)return s.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${a.message}`}),void console.error("C\xf3 l\u1ed7i x\u1ea3y ra",a.message);a.data.image.forEach(l=>{"active"===l.originalname?i.active_icon=l.filename:"inactive"===l.originalname?i.inactive_icon=l.filename:"warning"===l.originalname&&(i.warning_icon=l.filename)});const c=yield(0,b.n)(s.dtHttpService.create(i));0===c.status?(s.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 t\u1ea1o Ph\xe2n lo\u1ea1i th\xe0nh c\xf4ng"}),s.ref.close("success")):(s.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${c.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",c.message))}catch(a){s.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",a)}else s.onAdd2(i)})()}onAdd2(t){this.dtHttpService.create(t).subscribe({next:i=>{0===i.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 t\u1ea1o Ph\xe2n lo\u1ea1i th\xe0nh c\xf4ng"}),this.ref.close("success")):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${i.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i.message))},error:i=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i)}})}onEdit(t,i){var s=this;return(0,D.Z)(function*(){if(t&&0!==t.length)try{const a=yield(0,b.n)(s.dtHttpService.uploadFile(t,void 0));if(0!==a.status)return s.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${a.message}`}),void console.error("C\xf3 l\u1ed7i x\u1ea3y ra",a.message);a.data.image.forEach(l=>{"active"===l.originalname?i.active_icon=l.filename:"inactive"===l.originalname?i.inactive_icon=l.filename:"warning"===l.originalname&&(i.warning_icon=l.filename)});const c=yield(0,b.n)(s.dtHttpService.edit(s.deviceType.id,i.name,i.description,i.count_unit,i.active_icon,i.inactive_icon,i.warning_icon));0===c.status?(s.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 c\u1eadp nh\u1eadt Ph\xe2n lo\u1ea1i th\xe0nh c\xf4ng"}),s.ref.close("success")):(s.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${c.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",c.message))}catch(a){s.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",a)}else s.onEdit2(i)})()}onEdit2(t){this.dtHttpService.edit(this.deviceType.id,t.name,t.description,t.count_unit,void 0,void 0,void 0).subscribe({next:i=>{0===i.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 c\u1eadp nh\u1eadt Th\xf4ng s\u1ed1 th\xe0nh c\xf4ng"}),this.ref.close("success")):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${i.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i.message))},error:i=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i)}})}onDestroy(){this.ref.destroy()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.E7),e.Y36(u.S),e.Y36(p.qu),e.Y36(T.g),e.Y36(d.ez))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-or-edit-device-type"]],decls:70,vars:11,consts:[[3,"formGroup","ngSubmit"],[1,"outbound"],[1,"header","flex","align-items-center","justify-content-between","border-bottom-1","border-gray-300"],[1,"ml-2","text-xl","font-bold"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-danger","p-button-text",3,"click"],[1,"content"],[1,"p-fluid","m-2"],[1,"field","mb-2"],["for","name"],[1,"ml-2","text-red-500"],["id","name","type","text","aria-describedby","name-help","pInputText","","formControlName","name"],["id","name-help","class","text-red-500",4,"ngIf"],["for","desc"],["id","desc","rows","3","pInputTextarea","","formControlName","description"],["for","count_unit"],["id","count_unit","type","text","pInputText","","formControlName","count_unit"],["formControlName","is_combination","optionLabel","name","panelStyleClass","text-overflow-ellipsis text-sm",3,"options"],[1,"field","m-2"],[1,"border-round","border-1","border-gray-300","mb-1","p-2"],[1,"flex","align-items-center","mb-2"],[1,"ml-auto","mr-2"],[2,"max-width","24px",3,"src"],[1,"flex","align-items-center"],["type","file","accept","image/*",1,"file-input",3,"change"],["active",""],["pButton","","pRipple","","type","button","label","Ch\u1ecdn \u1ea3nh","icon","fa-solid fa-upload",1,"p-button-sm","p-button-outlined","mr-2",3,"click"],["inactive",""],[1,"border-round","border-1","border-gray-300","mb-2","p-2"],["warning",""],[1,"footer","flex","align-items-center","justify-content-end","border-top-1","border-gray-300"],["pButton","","pRipple","","type","button","label","H\u1ee7y b\u1ecf","icon","fa-solid fa-times",1,"p-button-outlined","mr-1",3,"click"],["pButton","","pRipple","","type","submit","label","L\u01b0u th\xf4ng tin","icon","fa-solid fa-floppy-disk",1,"mr-1",3,"disabled"],["id","name-help",1,"text-red-500"],[4,"ngIf"]],template:function(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2)(3,"span",3),e._uU(4),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return i.onDestroy()}),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),e._uU(10,"T\xean Ph\xe2n lo\u1ea1i "),e.TgZ(11,"span",9),e._uU(12,"(*)"),e.qZA()(),e._UZ(13,"input",10),e.YNc(14,le,3,2,"small",11),e.qZA(),e.TgZ(15,"div",7)(16,"label",12),e._uU(17,"M\xf4 t\u1ea3"),e.qZA(),e._UZ(18,"textarea",13),e.qZA(),e.TgZ(19,"div",7)(20,"label",14),e._uU(21,"\u0110\u01a1n v\u1ecb"),e.qZA(),e._UZ(22,"input",15),e.qZA(),e.TgZ(23,"div",7)(24,"label"),e._uU(25,"Lo\u1ea1i"),e.qZA(),e._UZ(26,"p-dropdown",16),e.qZA()(),e.TgZ(27,"div",17)(28,"div",7)(29,"span"),e._uU(30,"Bi\u1ec3u t\u01b0\u1ee3ng (icon) hi\u1ec3n th\u1ecb tr\xean b\u1ea3n \u0111\u1ed3"),e.qZA()(),e.TgZ(31,"div",18)(32,"div",19)(33,"span"),e._uU(34,"Icon ho\u1ea1t \u0111\u1ed9ng: "),e.qZA(),e.TgZ(35,"span",20),e._UZ(36,"img",21),e.qZA()(),e.TgZ(37,"div",22)(38,"input",23,24),e.NdJ("change",function(c){return i.onFileIconActiveSelect(c)}),e.qZA(),e.TgZ(40,"button",25),e.NdJ("click",function(){return e.CHM(s),e.MAs(39).click()}),e.qZA(),e.TgZ(41,"span"),e._uU(42),e.qZA()()(),e.TgZ(43,"div",18)(44,"div",19)(45,"span"),e._uU(46,"Icon kh\xf4ng ho\u1ea1t \u0111\u1ed9ng: "),e.qZA(),e.TgZ(47,"span",20),e._UZ(48,"img",21),e.qZA()(),e.TgZ(49,"div",22)(50,"input",23,26),e.NdJ("change",function(c){return i.onFileIconInActiveSelect(c)}),e.qZA(),e.TgZ(52,"button",25),e.NdJ("click",function(){return e.CHM(s),e.MAs(51).click()}),e.qZA(),e.TgZ(53,"span"),e._uU(54),e.qZA()()(),e.TgZ(55,"div",27)(56,"div",19)(57,"span"),e._uU(58,"Icon c\u1ea3nh b\xe1o: "),e.qZA(),e.TgZ(59,"span",20),e._UZ(60,"img",21),e.qZA()(),e.TgZ(61,"div",22)(62,"input",23,28),e.NdJ("change",function(c){return i.onFileWarningSelect(c)}),e.qZA(),e.TgZ(64,"button",25),e.NdJ("click",function(){return e.CHM(s),e.MAs(63).click()}),e.qZA(),e.TgZ(65,"span"),e._uU(66),e.qZA()()()()(),e.TgZ(67,"div",29)(68,"button",30),e.NdJ("click",function(){return i.onDestroy()}),e.qZA(),e._UZ(69,"button",31),e.qZA()()()}2&t&&(e.Q6J("formGroup",i.formGroup),e.xp6(4),e.Oqu(i.title),e.xp6(10),e.Q6J("ngIf",i.formGroup.controls.name.invalid&&i.formGroup.controls.name.touched),e.xp6(12),e.Q6J("options",i.isCombination),e.xp6(10),e.Q6J("src",i.iconActiveUrl,e.LSH),e.xp6(6),e.Oqu(i.getNameFile(i.fileIconActive)),e.xp6(6),e.Q6J("src",i.iconInActiveUrl,e.LSH),e.xp6(6),e.Oqu(i.getNameFile(i.fileIconInActive)),e.xp6(6),e.Q6J("src",i.iconWarningUrl,e.LSH),e.xp6(6),e.Oqu(i.getNameFile(i.fileIconWarning)),e.xp6(3),e.Q6J("disabled",i.formGroup.invalid))},directives:[p._Y,p.JL,p.sg,f.Hq,_.H,p.Fj,se.o,p.JJ,p.u,m.O5,oe.g,ae.Lt],styles:[".outbound[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;overflow:hidden}.outbound[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:45px}.outbound[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;top:45px;bottom:45px;left:0;width:100%;overflow:auto}.outbound[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;bottom:0;height:45px;left:0;width:100%}.file-input[_ngcontent-%COMP%]{display:none}"]}),n})();var pe=r(9269),de=r(7658),me=r(9955);const ue=["divBound"],he=["divTable"],ge=["divPaginator"];function ve(n,o){1&n&&(e.TgZ(0,"tr")(1,"th",27),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",28),e._uU(4,"T\xean "),e._UZ(5,"p-sortIcon",29),e.qZA(),e.TgZ(6,"th",30),e._uU(7,"M\xf4 t\u1ea3"),e.qZA(),e.TgZ(8,"th",31),e._uU(9,"\u0110\u01a1n v\u1ecb"),e.qZA(),e.TgZ(10,"th",32),e._uU(11,"Lo\u1ea1i"),e.qZA(),e.TgZ(12,"th",33),e._uU(13,"Th\u1eddi gian t\u1ea1o "),e._UZ(14,"p-sortIcon",34),e.qZA(),e.TgZ(15,"th",35),e._uU(16,"C\u1eadp nh\u1eadt "),e._UZ(17,"p-sortIcon",36),e.qZA()())}function fe(n,o){if(1&n&&(e.TgZ(0,"tr",37)(1,"td",27),e._uU(2),e.qZA(),e.TgZ(3,"td",30),e._uU(4),e.qZA(),e.TgZ(5,"td",30),e._uU(6),e.qZA(),e.TgZ(7,"td",31),e._uU(8),e.qZA(),e.TgZ(9,"td",32),e._uU(10),e.qZA(),e.TgZ(11,"td",38),e._uU(12),e.qZA(),e.TgZ(13,"td",38),e._uU(14),e.qZA()()),2&n){const t=o.$implicit,i=o.rowIndex,s=e.oxw(2);e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu((s.currentPage-1)*s.itemsPerPage+1+i),e.xp6(2),e.AsE("",t.name," (#",t.id,")"),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(t.count_unit),e.xp6(2),e.Oqu(t.is_combination_name),e.xp6(2),e.Oqu(s.convertTime(t.createdAt)),e.xp6(2),e.Oqu(s.convertTime(t.updatedAt))}}function _e(n,o){1&n&&(e.TgZ(0,"div",39),e._uU(1," Kh\xf4ng c\xf3 d\u1eef li\u1ec7u trong m\u1ee5c n\xe0y. "),e.qZA())}function ye(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).onAdd()}),e.qZA()}}function Te(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).onEdit()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.currentDeviceType)}}function be(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-splitButton",42),e.NdJ("onClick",function(){return e.CHM(t),e.oxw(2).onViewDetail()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("showTransitionOptions","200ms")("hideTransitionOptions","200ms")("model",t.moreCommands)("disabled",!t.currentDeviceType)}}const Ce=function(){return[15,20,30,50]};function xe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",2,3),e.NdJ("resize",function(){return e.CHM(t),e.oxw().onWindowResize()},!1,e.Jf7),e.TgZ(2,"div",4),e._UZ(3,"p-breadcrumb",5),e.TgZ(4,"div",6)(5,"h3",7),e._UZ(6,"i",8),e._uU(7,"Qu\u1ea3n l\xfd Ph\xe2n lo\u1ea1i "),e.qZA()(),e.TgZ(8,"div",9,10)(10,"p-table",11),e.NdJ("selectionChange",function(s){return e.CHM(t),e.oxw().currentDeviceType=s})("onRowSelect",function(s){return e.CHM(t),e.oxw().onRowSelect(s)})("onRowUnselect",function(s){return e.CHM(t),e.oxw().onRowUnselect(s)}),e.YNc(11,ve,18,0,"ng-template",12),e.YNc(12,fe,15,9,"ng-template",13),e.YNc(13,_e,2,0,"ng-template",14),e.qZA()()(),e.TgZ(14,"div",15,16)(16,"div",17)(17,"div",18),e.YNc(18,ye,1,0,"button",19),e.YNc(19,Te,1,1,"button",20),e.YNc(20,be,1,4,"p-splitButton",21),e.qZA(),e.TgZ(21,"div",22)(22,"p-paginator",23),e.NdJ("onPageChange",function(s){return e.CHM(t),e.oxw().onPageChange(s)}),e.qZA()(),e.TgZ(23,"div",24)(24,"button",25),e.NdJ("click",function(){return e.CHM(t),e.oxw().onReSync()}),e.qZA(),e.TgZ(25,"span",26),e._uU(26),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("model",t.pathLinks)("home",t.homeLink),e.xp6(7),e.Q6J("selection",t.currentDeviceType)("value",t.deviceTypes)("scrollable",!0)("loading",t.loading),e.xp6(8),e.Q6J("ngIf",t.permission.device_type.create),e.xp6(1),e.Q6J("ngIf",t.permission.device_type.edit),e.xp6(1),e.Q6J("ngIf",t.permission.device_type.self),e.xp6(2),e.Q6J("rows",t.itemsPerPage)("totalRecords",t.totalItems)("rowsPerPageOptions",e.DdM(17,Ce))("showJumpToPageDropdown",!0)("showPageLinks",!1),e.xp6(4),e.lnq("Hi\u1ec3n th\u1ecb ",(t.currentPage-1)*t.itemsPerPage+1,"-",(t.currentPage-1)*t.itemsPerPage+t.itemsPerPage>t.totalItems?t.totalItems:(t.currentPage-1)*t.itemsPerPage+t.itemsPerPage,"/",t.totalItems,"")}}function Ze(n,o){1&n&&(e._UZ(0,"i",50),e.TgZ(1,"span",51),e._uU(2,"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o m\u1ee5c n\xe0y!"),e.qZA())}function Pe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",43)(1,"p-messages",44),e.YNc(2,Ze,3,0,"ng-template",45),e.qZA()(),e.TgZ(3,"div",46)(4,"div",47),e.NdJ("click",function(){return e.CHM(t),e.oxw().onGoBackHome()}),e._UZ(5,"span",48),e.TgZ(6,"span",49),e._uU(7,"Quay l\u1ea1i Trang ch\u1ee7"),e.qZA()()()}}const Ae=[{path:"",component:(()=>{class n{constructor(t,i,s,a,c,l,we){this.dtHttpService=t,this.messageService=i,this.renderer=s,this.dialogService=a,this.permissionService=c,this.router=l,this.confirmService=we,this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.deviceTypes=[],this.template=!1,this.loading=!1}ngOnDestroy(){this.subPermission&&this.subPermission.unsubscribe(),this.loadingTime&&clearTimeout(this.loadingTime)}setStyleDiv(){this.windowWidth=this.divBound.nativeElement.offsetWidth,this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight-62}px`)}ngAfterViewInit(){this.setStyleDiv()}onWindowResize(){this.setStyleDiv()}calcWidth(){let t="";return t=this.windowWidth<576?.95*this.windowWidth+"px":this.windowWidth>=576&&this.windowWidth<768?.55*this.windowWidth+"px":this.windowWidth>=768&&this.windowWidth<992?.45*this.windowWidth+"px":this.windowWidth>=992&&this.windowWidth<1400?.4*this.windowWidth+"px":.3*this.windowWidth+"px",t}ngOnInit(){this.subPermission=this.permissionService.currentPermission.subscribe(t=>{t&&(this.permission=t,this.initForm(),this.fetchListOfDeviceTypes())})}initForm(){this.pathLinks=[{label:"Thi\u1ebft b\u1ecb",disabled:!0},{label:"Ph\xe2n lo\u1ea1i",disabled:!0}],this.homeLink={icon:"fa-solid fa-home",routerLink:"/"},this.moreCommands=[{label:"X\xf3a b\u1ecf",icon:"fa-solid fa-minus",disabled:!0,command:()=>{this.onDelete()}}]}fetchListOfDeviceTypes(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.dtHttpService.getList(this.is_combination,2,this.template,this.itemsPerPage,this.offset).subscribe({next:t=>{0===t.status?(this.deviceTypes=t.data.rows,this.totalItems=t.data.count,this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime),this.currentDeviceType=void 0):2===t.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${t.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t.message),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime))},error:t=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}onRowSelect(t){this.moreCommands[0].disabled=!(this.permission.device_type.delete&&this.currentDeviceType)}onRowUnselect(t){this.moreCommands[0].disabled=!(this.permission.device_type.delete&&this.currentDeviceType)}onPageChange(t){this.currentPage=t.page+1,this.itemsPerPage=t.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.fetchListOfDeviceTypes()}onReSync(){this.fetchListOfDeviceTypes()}onAdd(){this.dialogService.open(E,{showHeader:!1,height:"730px",width:this.calcWidth(),contentStyle:{padding:"0",margin:0}}).onClose.subscribe(i=>{i&&this.fetchListOfDeviceTypes()})}onEdit(){this.dialogService.open(E,{data:{deviceType:this.currentDeviceType,title:"C\u1eadp nh\u1eadt Ph\xe2n lo\u1ea1i"},showHeader:!1,height:"730px",width:this.calcWidth(),contentStyle:{padding:"0",margin:0}}).onClose.subscribe(i=>{i&&this.fetchListOfDeviceTypes()})}onViewDetail(){this.dialogService.open(ne,{data:{deviceType:this.currentDeviceType},showHeader:!1,width:"99vw",height:"99vh",contentStyle:{padding:"0",margin:0}})}onDelete(){this.confirmService.confirm({message:`B\u1ea1n c\xf3 mu\u1ed1n x\xf3a Ph\xe2n lo\u1ea1i "${this.currentDeviceType.name}" kh\xf4ng?`,header:"X\xe1c nh\u1eadn x\xf3a Ph\xe2n lo\u1ea1i",icon:"pi pi-info-circle"}).then(t=>{t&&this.dtHttpService.delete(this.currentDeviceType.id).subscribe({next:i=>{0===i.status?(this.currentDeviceType=void 0,this.fetchListOfDeviceTypes(),this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 x\xf3a ph\xe2n lo\u1ea1i th\xe0nh c\xf4ng"})):2===i.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${i.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i.message))},error:i=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i)}})}).catch(t=>{})}convertTime(t){return C.I.isoToVnTime(t)}onGoBackHome(){this.router.navigate(["/"])}onComeback(){localStorage.removeItem(h.o.USER),sessionStorage.removeItem(h.o.ACC),this.router.navigate(["/come-back"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T.g),e.Y36(d.ez),e.Y36(e.Qsj),e.Y36(u.xA),e.Y36(x.$),e.Y36(v.F0),e.Y36(pe.I))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-device-type-management"]],viewQuery:function(t,i){if(1&t&&(e.Gf(ue,5,e.SBq),e.Gf(he,5,e.SBq),e.Gf(ge,5,e.SBq)),2&t){let s;e.iGM(s=e.CRH())&&(i.divBound=s.first),e.iGM(s=e.CRH())&&(i.divTable=s.first),e.iGM(s=e.CRH())&&(i.divPaginator=s.first)}},decls:3,vars:2,consts:[["class","relative h-full w-full",3,"resize",4,"ngIf","ngIfElse"],["noPermission",""],[1,"relative","h-full","w-full",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["styleClass","text-sm p-1",3,"model","home"],[1,"flex","align-items-center"],[1,"text-blue-700","m-0","px-2","pt-2","pb-0"],[1,"fa-solid","fa-list","mr-2"],[1,"page-content","mt-1"],["divTable",""],["selectionMode","single","styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"selection","value","scrollable","loading","selectionChange","onRowSelect","onRowUnselect"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"absolute","bottom-0","left-0","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-5","flex","align-items-center"],["pButton","","pRipple","","type","button","label","Th\xeam","icon","fa-solid fa-plus","class","mx-1",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","label","Ch\u1ec9nh s\u1eeda","icon","fa-solid fa-pen","class","mr-1",3,"disabled","click",4,"ngIf"],["label","Chi ti\u1ebft","icon","fa-solid fa-wand-sparkles",3,"showTransitionOptions","hideTransitionOptions","model","disabled","onClick",4,"ngIf"],[1,"col-12","md:col-5","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-2","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text","m-0","p-1",3,"click"],[1,"ml-1"],[2,"width","60px","max-width","60px"],["pSortableColumn","name",2,"min-width","300px"],["field","name"],[2,"min-width","300px"],[2,"min-width","100px"],[2,"min-width","150px"],["pSortableColumn","createdAt",2,"min-width","200px"],["field","createdAt"],["pSortableColumn","updatedAt",2,"min-width","200px"],["field","updatedAt"],[3,"pSelectableRow"],[2,"min-width","200px"],[1,"p-fluid","p-2"],["pButton","","pRipple","","type","button","label","Th\xeam","icon","fa-solid fa-plus",1,"mx-1",3,"click"],["pButton","","pRipple","","type","button","label","Ch\u1ec9nh s\u1eeda","icon","fa-solid fa-pen",1,"mr-1",3,"disabled","click"],["label","Chi ti\u1ebft","icon","fa-solid fa-wand-sparkles",3,"showTransitionOptions","hideTransitionOptions","model","disabled","onClick"],[1,"flex","align-items-center","justify-content-center"],["severity","error"],["pTemplate",""],[1,"flex","align-items-center","justify-content-center","cursor-pointer"],["pRipple","",1,"flex","align-items-center","justify-content-center","w-full","h-4rem","max-w-20rem","bg-blue-500","border-round-md","shadow-8","text-white","font-bold",3,"click"],[1,"fa-solid","fa-home"],[1,"text-center","text-xl","mx-2"],[1,"pi","pi-times-circle"],[1,"ml-2"]],template:function(t,i){if(1&t&&(e.YNc(0,xe,27,18,"div",0),e.YNc(1,Pe,8,0,"ng-template",null,1,e.W1O)),2&t){const s=e.MAs(2);e.Q6J("ngIf",i.permission.device_type.self)("ngIfElse",s)}},directives:[m.O5,de.a,g.iA,d.jx,g.lQ,g.fz,g.Ei,f.Hq,_.H,me.a,Z.D,A.V],styles:[""]}),n})()}];let De=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[v.Bz.forChild(Ae)],v.Bz]}),n})();var Ee=r(4695);let Ie=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[m.ez,De,Ee.m]]}),n})()}}]);