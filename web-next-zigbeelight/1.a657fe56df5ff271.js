(self.webpackChunkweb_next_zigbeelight=self.webpackChunkweb_next_zigbeelight||[]).push([[1],{6015:(z,q,_)=>{"use strict";_.d(q,{x:()=>R});var c=_(520),y=_(2340),e=_(5e3);let R=(()=>{class b{constructor(l){this.http=l}getList(l,o,a,p,u,r,x,A){let f=new c.LE;return f=f.append("device_subtype_id",l),f=f.append("limit",o),f=f.append("offset",a),null!=p&&null!=p&&(f=f.append("has_parent",p)),u&&r&&(f=f.append("time_start",u),f=f.append("time_end",r)),x&&(f=f.append("name",x)),A&&(f=f.append("address",A)),this.http.get(`${y.N.url.BASE_URL}/device`,{params:f})}createNumberOfDevices(l,o,a,p,u){let r=new c.LE;return r=r.append("device_subtype_id",l),r=r.append("count",o||1),r=r.append("prefix",a),(null!=p||null!=p)&&(null!=u||null!=u)&&(r=r.append("latitude",p),r=r.append("longitude",u)),this.http.post(`${y.N.url.BASE_URL}/device`,r)}editInfo(l){let o=new c.LE;for(const a of Object.keys(l))null!=l[a]&&null!=l[a]&&(o=o.append(a,l[a]));return this.http.put(`${y.N.url.BASE_URL}/device/${l.id}`,o)}getInfo(l){return this.http.get(`${y.N.url.BASE_URL}/device/${l}`)}getDeviceByCodeByGuest(l){return this.http.get(`${y.N.url.BASE_URL}/public/device/${l}`)}getDeviceByCode(l){let o=new c.LE;return l&&(o=o.append("device_code",l)),this.http.get(`${y.N.url.BASE_URL}/device/bycode`,{params:o})}delete(l){return this.http.delete(`${y.N.url.BASE_URL}/device/${l}`)}getDeviceInside(l,o,a){let p=new c.LE;return p=p.append("limit",o),p=p.append("offset",a),this.http.get(`${y.N.url.BASE_URL}/device/${l}/inside`,{params:p})}deleteDeviceInside(l,o){return this.http.delete(`${y.N.url.BASE_URL}/device/${l}/inside/delete/${o}`)}addDeviceInside(l,o){let a=new c.LE;return o&&0!==o.length&&o.forEach(p=>{a=a.append("device_ids[]",p)}),this.http.put(`${y.N.url.BASE_URL}/device/${l}/inside/add`,a)}getDeviceParameterAndValue(l,o){let a=new c.LE;return a=a.append("device_id",l),o&&(a=a.append("case",o)),this.http.get(`${y.N.url.BASE_URL}/device/getdevicesparameters`,{params:a})}getAllDeviceForSearchSuggest(){return this.http.get(`${y.N.url.BASE_URL}/device/data-for-search`)}getDeviceByLocation(l,o,a,p,u,r,x){let A=new c.LE;return A=A.append("lat1",l),A=A.append("lat2",a),A=A.append("long1",o),A=A.append("long2",p),A=A.append("limit",u),r&&r.length?r.forEach(f=>{A=A.append("map_ids[]",f)}):r&&0==r.length&&(A=A.append("map_ids[]",null)),x&&(A=A.append("is_displayed_on_map",x)),this.http.get(`${y.N.url.BASE_URL}/device/onmap`,{params:A})}getDeviceByLocation2(l,o,a,p,u){let r=new c.LE;return r=r.append("lat1",l),r=r.append("lat2",a),r=r.append("long1",o),r=r.append("long2",p),r=r.append("limit",u),this.http.get(`${y.N.url.BASE_URL}/device/onmap2`,{params:r})}control(l,o,a,p,u){let r=new c.LE;return o&&(r=r.append("parameter_id",o)),a&&(r=r.append("group_id",a)),p&&(r=r.append("port_id",p)),r=r.append("value",u),this.http.put(`${y.N.url.BASE_URL}/device/${l}/control`,r)}controlAll(l,o){let a=new c.LE;return a=a.append("value",o),this.http.post(`${y.N.url.BASE_URL}/device/${l}/control-cabinet-all`,a)}getEnergyNow(l){let o=new c.LE;return l&&l.length&&l.forEach(a=>{o=o.append("device_ids[]",a)}),this.http.get(`${y.N.url.BASE_URL}/power/latest`,{params:o})}clearLeakageCurrentActivated(l,o){let a=new c.LE;return a=a.append("device_id",l),a=a.append("phase",o),this.http.delete(`${y.N.url.BASE_URL}/device/cabinet/xoa-cbdr`,{params:a})}getListCabinet(){return this.http.get(`${y.N.url.BASE_URL}/device/cabinet`)}createGroupOfCabinet(l,o,a){let p=new c.LE;return p=p.append("mac",l),p=p.append("group_name",o),a&&0!==a.length&&a.forEach(u=>{p=p.append("device_ids[]",u)}),this.http.post(`${y.N.url.BASE_URL}/device/cabinet/create-group`,p)}updateGroupOfCabinet(l,o,a){let p=new c.LE;return p=p.append("mac",l),p=p.append("group_id",o),a&&0!==a.length&&a.forEach(u=>{p=p.append("device_ids[]",u)}),this.http.put(`${y.N.url.BASE_URL}/device/cabinet/group`,p)}removeGroupOfCabinet(l,o){let a=new c.LE;return a=a.append("mac",l),a=a.append("group_id",o),this.http.delete(`${y.N.url.BASE_URL}/device/cabinet/group`,{params:a})}getDeviceInsideGroup(l,o){let a=new c.LE;return a=a.append("mac",l),a=a.append("group_id",o),this.http.get(`${y.N.url.BASE_URL}/device/cabinet/group`,{params:a})}setTimeSent(l,o){let a=new c.LE;return a=a.append("timeSent",o),this.http.put(`${y.N.url.BASE_URL}/device/${l}/setTimeSent`,a)}setMac(l,o){let a=new c.LE;return a=a.append("mac",o),this.http.put(`${y.N.url.BASE_URL}/device/${l}/capNhatMacChoThietBi`,a)}configDevice(l,o,a){let p=new c.LE;if(!o||0===o.length||!a||0===a.length||o.length!=a.length)throw new Error("Danh s\xe1ch th\xf4ng s\u1ed1 c\u1ea5u h\xecnh kh\xf4ng h\u1ee3p l\u1ec7");return o.forEach(u=>{p=p.append("parameters[]",u)}),a.forEach(u=>{p=p.append("values[]",u)}),this.http.put(`${y.N.url.BASE_URL}/device/${l}/config`,p)}getDevicePowerWarningSetting(l){let o=new c.LE;return o=o.append("device_id",l),this.http.get(`${y.N.url.BASE_URL}/powerwarning`,{params:o})}createOrUpdatePowerWarningSetting(l,o,a){let p=new c.LE;return p=p.append("device_id",l),o&&(p=p.append("script_id",o)),a&&0!==a.length&&a.forEach(u=>{p=p.append("power_warning_items[]",JSON.stringify(u))}),this.http.put(`${y.N.url.BASE_URL}/powerwarning`,p)}updateDIMsForCabinet(l){return this.http.put(`${y.N.url.BASE_URL}/device/${l}/capNhatDenDimChoTu`,{})}updateDIMsForListOfCabinets(l){let o=new c.LE;if(!l||0==l.length)throw new Error("Danh s\xe1ch macs[] kh\xf4ng h\u1ee3p l\u1ec7");return l.forEach(a=>{a&&(o=o.append("mac[]",a))}),this.http.post(`${y.N.url.BASE_URL}/device/cabinet/update-list-light`,o)}createPortOfCabinet(l){let o=new c.LE;return o=o.append("device_id",l),this.http.post(`${y.N.url.BASE_URL}/device/cabinet/port`,o)}removePortOfCabinet(l,o){let a=new c.LE;return a=a.append("device_id",l),a=a.append("port_id",o),this.http.delete(`${y.N.url.BASE_URL}/device/cabinet/port`,{params:a})}settingUIWarning(l,o,a,p,u,r,x,A,f,T,C,P){let M=new c.LE;return M=M.append("v1_high",l),M=M.append("v1_low",o),M=M.append("v2_high",a),M=M.append("v2_low",p),M=M.append("v3_high",u),M=M.append("v3_low",r),M=M.append("i1_high",x),M=M.append("i2_high",A),M=M.append("i3_high",f),C&&0!==C.length&&C.forEach(U=>{M=M.append("device_ids[]",U)}),T&&(M=M.append("company_id",T)),P&&(M=M.append("device_subtype_id",P)),this.http.put(`${y.N.url.BASE_URL}/device/config/warning`,M)}getMaintenance(l,o,a,p){let u=new c.LE;return u=u.append("limit",l),u=u.append("offset",o),(null!=a||null!=a)&&(u=u.append("maintain_warning",a)),(null!=p||null!=p)&&(u=u.append("maintain_state",p)),this.http.get(`${y.N.url.BASE_URL}/device/maintain`,{params:u})}getOperationTime(l,o,a){let p=new c.LE;return o&&a&&(p=p.append("time_start",o),p=p.append("time_end",a)),l&&0!==l.length&&l.forEach(u=>{p=p.append("device_ids[]",u)}),this.http.get(`${y.N.url.BASE_URL}/log/onoff/sum`,{params:p})}getOnOff(l,o,a,p,u){let r=new c.LE;return p&&u&&(r=r.append("time_start",p),r=r.append("time_end",u)),r=r.append("limit",o),r=r.append("offset",a),l&&(r=r.append("device_id",l)),this.http.get(`${y.N.url.BASE_URL}/log/onoff`,{params:r})}toggleMaintain(l,o){let a=new c.LE;return a=a.append("maintain_state",o),l&&0!==l.length&&l.forEach(p=>{a=a.append("device_ids[]",p)}),this.http.put(`${y.N.url.BASE_URL}/device/config/maintain_state`,a)}setMaintainTime(l,o,a){let p=new c.LE;return p=p.append("maintain_time",o),a&&(p=p.append("work_time",0)),l&&0!==l.length&&l.forEach(u=>{p=p.append("device_ids[]",u)}),this.http.put(`${y.N.url.BASE_URL}/device/maintain`,p)}toggleWarning(l,o){let a=new c.LE;return a=a.append("warning_mode",o),l&&0!==l.length&&l.forEach(p=>{a=a.append("device_ids[]",p)}),this.http.put(`${y.N.url.BASE_URL}/device/config/warning_mode`,a)}}return b.\u0275fac=function(l){return new(l||b)(e.LFG(c.eN))},b.\u0275prov=e.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})()},6180:(z,q,_)=>{"use strict";_.d(q,{R:()=>r});var c=_(520),y=_(4004),e=_(2340);class R{}var u=_(5e3);let r=(()=>{class x{constructor(f){this.http=f}getListOfTroubles(f,T,C,P,M,U,k,Z,S,$,O,v,m){let d=new c.LE;return d=d.append("limit",O),d=d.append("offset",v),(null!=f||null!=f)&&(d=d.append("group",f)),(null!=T||null!=T)&&(d=d.append("trouble_type_id",T)),(null!=P||null!=P)&&(d=d.append("time_start",P)),(null!=M||null!=M)&&(d=d.append("time_end",M)),(null!=C||null!=C)&&(d=d.append("state",C)),(null!=m||null!=m)&&(d=d.append("device_id",m)),U&&k&&Z&&S&&(d=d.append("lat1",U),d=d.append("lat2",Z),d=d.append("long1",k),d=d.append("long2",S)),(null!=$||null!=$)&&(d=d.append("created_by_user_id",$)),this.http.get(`${e.N.url.BASE_URL}/trouble`,{params:d})}changleState(f,T){let C=new c.LE;return C=C.append("state",T),this.http.put(`${e.N.url.BASE_URL}/trouble/${f}`,C)}changleStateAll(f){let T=new c.LE;return T=T.append("state",f),this.http.put(`${e.N.url.BASE_URL}/trouble/all`,T)}createReport(f,T,C,P,M,U,k,Z,S){const $=new FormData;return $.append("content",f),$.append("latitude",T.toString()),$.append("longitude",C.toString()),$.append("address",P),$.append("trouble_type_id",M.toString()),U&&$.append("company_id",U.toString()),k&&$.append("device_id",k.toString()),Z&&0!==Z.length&&Z.forEach(O=>{$.append("image",O)}),S&&0!==S.length&&S.forEach(O=>{$.append("file",O)}),this.http.post(`${e.N.url.BASE_URL}/trouble`,$,{reportProgress:!0,observe:"events"}).pipe((0,y.U)(O=>{var v=new R;switch(O.type){case c.dt.UploadProgress:const m=Math.round(100*O.loaded/O.total);return v.status=m,v.message="progress",v;case c.dt.Response:return O.body;default:return v.status=O.type,v.message="Unhandled event",v}}))}createReportByGuest(f,T,C,P,M,U,k,Z,S){const $=new FormData;return $.append("content",f),$.append("latitude",T.toString()),$.append("longitude",C.toString()),$.append("address",P),$.append("trouble_type_id",M.toString()),U&&$.append("company_id",U.toString()),k&&$.append("device_id",k.toString()),Z&&0!==Z.length&&Z.forEach(O=>{$.append("image",O)}),S&&0!==S.length&&S.forEach(O=>{$.append("file",O)}),this.http.post(`${e.N.url.BASE_URL}/public/trouble`,$,{reportProgress:!0,observe:"events"}).pipe((0,y.U)(O=>{var v=new R;switch(O.type){case c.dt.UploadProgress:const m=Math.round(100*O.loaded/O.total);return v.status=m,v.message="progress",v;case c.dt.Response:return O.body;default:return v.status=O.type,v.message="Unhandled event",v}}))}getListOfTroubleTypes(f,T,C){let P=new c.LE;return P=P.append("limit",f),P=P.append("offset",T),C>=0&&(P=P.append("is_from_user",C)),this.http.get(`${e.N.url.BASE_URL}/trouble/type`,{params:P})}getListOfTroubleTypesByGuest(f,T){let C=new c.LE;return C=C.append("company_id",f),T>=0&&(C=C.append("is_from_user",T)),this.http.get(`${e.N.url.BASE_URL}/public/trouble/type`,{params:C})}createTroubleType(f,T){let C=new c.LE;return C=C.append("name",f),T&&(C=C.append("description",T)),this.http.post(`${e.N.url.BASE_URL}/trouble/type`,C)}editTroubleType(f,T,C){let P=new c.LE;return T&&(P=P.append("name",T)),C&&(P=P.append("description",C)),this.http.put(`${e.N.url.BASE_URL}/trouble/type/${f}`,P)}deleteTroubleType(f){return this.http.delete(`${e.N.url.BASE_URL}/trouble/type/${f}`)}changeTroubleTypeForTrouble(f,T){let C=new c.LE;return C=C.append("trouble_type_id",T),this.http.put(`${e.N.url.BASE_URL}/trouble/${f}`,C)}editTroubleDisplayOnMap(f,T){let C=new c.LE;return C=C.append("is_displayed_on_map",T.toString()),this.http.put(`${e.N.url.BASE_URL}/trouble/${f}`,C)}}return x.\u0275fac=function(f){return new(f||x)(u.LFG(c.eN))},x.\u0275prov=u.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"}),x})()},9269:(z,q,_)=>{"use strict";_.d(q,{I:()=>o});var c=_(5e3),y=_(5330),e=_(9808),R=_(845),b=_(5787);let B=(()=>{class a{constructor(u,r){this.ref=u,this.config=r,this.icon="pi pi-info-circle"}ngOnInit(){this.config.data&&(this.message=this.config.data.message,this.icon=this.config.data.icon)}accept(){this.ref.close(!0)}dismiss(){this.ref.destroy()}}return a.\u0275fac=function(u){return new(u||a)(c.Y36(y.E7),c.Y36(y.S))},a.\u0275cmp=c.Xpm({type:a,selectors:[["app-confirm-dialog"]],decls:8,vars:2,consts:[[1,"diag"],[1,"outbound"],[1,"content","flex","align-items-center","p-2"],[1,"mx-3",2,"font-size","2rem",3,"ngClass"],[1,"footer","flex","align-items-center","justify-content-end"],["pButton","","pRipple","","type","button","label","H\u1ee7y b\u1ecf","icon","pi pi-times",1,"p-button-outlined","mr-1",3,"click"],["pButton","","pRipple","","type","button","label","C\xf3","icon","pi pi-check",1,"mr-1",3,"click"]],template:function(u,r){1&u&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2),c._UZ(3,"i",3),c._uU(4),c.qZA(),c.TgZ(5,"div",4)(6,"button",5),c.NdJ("click",function(){return r.dismiss()}),c.qZA(),c.TgZ(7,"button",6),c.NdJ("click",function(){return r.accept()}),c.qZA()()()()),2&u&&(c.xp6(3),c.Q6J("ngClass",r.icon),c.xp6(1),c.hij(" ",r.message," "))},directives:[e.mk,R.Hq,b.H],styles:["@media screen and (max-width: 639.99px){.diag[_ngcontent-%COMP%]{width:99vw}}@media screen and (min-width: 640px) and (max-width: 959.99px){.diag[_ngcontent-%COMP%]{width:75vw}}@media screen and (min-width: 960px) and (max-width: 1365.99px){.diag[_ngcontent-%COMP%]{width:55vw}}@media screen and (min-width: 1366px){.diag[_ngcontent-%COMP%]{width:45vw}}.outbound[_ngcontent-%COMP%]{position:absolute;top:55px;bottom:0;left:0;right:0;overflow:hidden}.outbound[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;top:0;bottom:45px;left:0;width:100%;overflow:auto}.outbound[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;bottom:0;height:45px;left:0;width:100%}"]}),a})(),o=(()=>{class a{constructor(u){this.dialogService=u}confirm(u){return new Promise((r,x)=>{const A=this.dialogService.open(B,{header:u.header,data:{message:u.message,icon:u.icon},height:"200px",contentStyle:{padding:"0",margin:0}});A.onClose.subscribe(f=>{f&&r(f)}),A.onDestroy.subscribe(()=>x(!1))})}}return a.\u0275fac=function(u){return new(u||a)(c.LFG(y.xA))},a.\u0275prov=c.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},6675:(z,q,_)=>{"use strict";_.d(q,{I:()=>b,Q:()=>B});var c=_(1764),y=_.n(c),e=_(5268),R=_.n(e);y().extend(R());class b{static isoToVnTime(o){return o&&0!==o.length?y().utc(o).local().format("HH:mm:ss DD/MM/YYYY"):"N/A"}}class B{static toDigis(o,a){if(o)return o.toLocaleString("en-us",{minimumFractionDigits:a,maximumFractionDigits:a});if(0==o){let p="";for(let u=0;u<a;u++)p+="0";return a?`0.${p}`:"0"}return"---"}}},1001:(z,q,_)=>{"use strict";_.r(q),_.d(q,{MapLayerModule:()=>Ke});var c=_(9808),y=_(9979),e=_(5e3),R=_(6675),b=_(2382),B=_(5330),l=_(2852),o=_(9783),a=_(845),p=_(5787),u=_(1424),r=_(4036),x=_(3407);function A(n,h){1&n&&(e.TgZ(0,"div"),e._uU(1," *C\u1ea7n \u0111i\u1ec1n t\xean cho L\u1edbp b\u1ea3n \u0111\u1ed3."),e.qZA())}function f(n,h){1&n&&(e.TgZ(0,"div"),e._uU(1," *T\xean L\u1edbp b\u1ea3n \u0111\u1ed3 d\xe0i \xedt nh\u1ea5t 2 k\xfd t\u1ef1."),e.qZA())}function T(n,h){if(1&n&&(e.TgZ(0,"small",18),e.YNc(1,A,2,0,"div",19),e.YNc(2,f,2,0,"div",19),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.formGroup.controls.name.invalid),e.xp6(1),e.Q6J("ngIf",t.formGroup.controls.name.errors.minlength)}}let C=(()=>{class n{constructor(t,i,s,I,F){this.ref=t,this.config=i,this.formBuilder=s,this.mlHttpService=I,this.messageService=F,this.title="Th\xeam m\u1edbi L\u1edbp b\u1ea3n \u0111\u1ed3",this.typeOptions=[{name:"L\u1edbp b\u1ea3n \u0111\u1ed3 \u0110\u1ed1i t\u01b0\u1ee3ng",value:0},{name:"L\u1edbp b\u1ea3n \u0111\u1ed3 Tuy\u1ebfn c\xe1p",value:2},{name:"\u0110\u1ed9i tu\u1ea7n tra",value:3},{name:"Tr\u1ea1m s\u1eeda ch\u1eefa",value:4},{name:"Nhi\u1ec7m v\u1ee5",value:5}]}ngOnInit(){this.formGroup=this.formBuilder.group({name:["",[b.kI.required,b.kI.minLength(2)]],description:[""],type:[0,[b.kI.required]]}),this.config.data&&(this.mapLayer=this.config.data.mapLayer,this.title=this.config.data.title,this.formGroup.setValue({name:this.mapLayer.name,description:this.mapLayer.description,type:this.mapLayer.type}),this.formGroup.controls.type.disable())}onSubmit(){this.mapLayer?this.onEdit():this.onAdd()}onAdd(){this.mlHttpService.create(this.formGroup.value.name,this.formGroup.value.description,this.formGroup.value.type).subscribe({next:t=>{0===t.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 t\u1ea1o L\u1edbp b\u1ea3n \u0111\u1ed3 th\xe0nh c\xf4ng"}),this.ref.close("success")):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${t.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t.message))},error:t=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t)}})}onEdit(){this.mlHttpService.edit(this.mapLayer.id,this.formGroup.value.name,this.formGroup.value.description).subscribe({next:t=>{0===t.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 c\u1eadp nh\u1eadt L\u1edbp b\u1ea3n \u0111\u1ed3 th\xe0nh c\xf4ng"}),this.ref.close("success")):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${t.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t.message))},error:t=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t)}})}onDestroy(){this.ref.destroy()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(B.E7),e.Y36(B.S),e.Y36(b.qu),e.Y36(l.z),e.Y36(o.ez))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-or-edit-map-layer"]],decls:28,vars:5,consts:[[3,"formGroup","ngSubmit"],[1,"outbound"],[1,"header","flex","align-items-center","justify-content-between","border-bottom-1","border-gray-300"],[1,"ml-2","text-xl","font-bold"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-danger","p-button-text",3,"click"],[1,"content"],[1,"p-fluid","m-2"],[1,"field","mb-2"],["for","name"],[1,"ml-2","text-red-500"],["id","name","type","text","aria-describedby","name-help","pInputText","","formControlName","name"],["id","name-help","class","text-red-500",4,"ngIf"],["formControlName","type","optionLabel","name","optionValue","value","emptyMessage","Ch\u1ecdn Ph\xe2n lo\u1ea1i","emptyFilterMessage","Kh\xf4ng c\xf3 danh m\u1ee5c","panelStyleClass","text-overflow-ellipsis text-sm",3,"options"],["for","desc"],["id","desc","rows","6","pInputTextarea","","formControlName","description"],[1,"footer","flex","align-items-center","justify-content-end","border-top-1","border-gray-300"],["pButton","","pRipple","","type","button","label","H\u1ee7y b\u1ecf","icon","fa-solid fa-times",1,"p-button-outlined","mr-1",3,"click"],["pButton","","pRipple","","type","submit","label","L\u01b0u th\xf4ng tin","icon","fa-solid fa-floppy-disk",1,"mr-1",3,"disabled"],["id","name-help",1,"text-red-500"],[4,"ngIf"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2)(3,"span",3),e._uU(4),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return i.onDestroy()}),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),e._uU(10,"T\xean l\u1edbp "),e.TgZ(11,"span",9),e._uU(12,"(*)"),e.qZA()(),e._UZ(13,"input",10),e.YNc(14,T,3,2,"small",11),e.qZA(),e.TgZ(15,"div",7)(16,"label"),e._uU(17,"Ph\xe2n lo\u1ea1i "),e.TgZ(18,"span",9),e._uU(19,"(*)"),e.qZA()(),e._UZ(20,"p-dropdown",12),e.qZA(),e.TgZ(21,"div",7)(22,"label",13),e._uU(23,"M\xf4 t\u1ea3"),e.qZA(),e._UZ(24,"textarea",14),e.qZA()()(),e.TgZ(25,"div",15)(26,"button",16),e.NdJ("click",function(){return i.onDestroy()}),e.qZA(),e._UZ(27,"button",17),e.qZA()()()),2&t&&(e.Q6J("formGroup",i.formGroup),e.xp6(4),e.Oqu(i.title),e.xp6(10),e.Q6J("ngIf",i.formGroup.controls.name.invalid&&i.formGroup.controls.name.touched),e.xp6(6),e.Q6J("options",i.typeOptions),e.xp6(7),e.Q6J("disabled",i.formGroup.invalid))},directives:[b._Y,b.JL,b.sg,a.Hq,p.H,b.Fj,u.o,b.JJ,b.u,c.O5,r.Lt,x.g],styles:[".outbound[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;overflow:hidden}.outbound[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:45px}.outbound[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;top:45px;bottom:45px;left:0;width:100%;overflow:auto}.outbound[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;bottom:0;height:45px;left:0;width:100%}.file-input[_ngcontent-%COMP%]{display:none}"]}),n})();var P=_(5431),M=_(3542),U=_(8952),k=_(4132);const Z=["divBound"],S=["divTable"],$=["divPaginator"];function O(n,h){1&n&&(e.TgZ(0,"tr")(1,"th",16),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",17),e._uU(4,"\u0110\u1eb7c t\xednh"),e.qZA(),e.TgZ(5,"th",17),e._uU(6,"Chi ti\u1ebft"),e.qZA()())}function v(n,h){if(1&n&&(e.TgZ(0,"tr")(1,"td",16),e._uU(2),e.qZA(),e.TgZ(3,"td",17),e._uU(4),e.qZA(),e.TgZ(5,"td",17),e._uU(6),e.qZA()()),2&n){const t=h.$implicit,i=h.rowIndex;e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.key),e.xp6(2),e.Oqu(t.value)}}const m=function(){return[15,20,30,50]};let d=(()=>{class n{constructor(t){this.renderer=t,this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.characteristics=[]}ngOnInit(){this.mapLayer&&this.getCharacteristics()}ngAfterViewChecked(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight}px`)}onPageChange(t){this.currentPage=t.page+1,this.itemsPerPage=t.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.getCharacteristics()}onReSync(){this.getCharacteristics()}convertTime(t){return R.I.isoToVnTime(t)}getCharacteristics(){this.totalItems=0;for(const t in this.mapLayer)if("name"==t)this.characteristics[this.totalItems]={key:"T\xean",value:this.mapLayer[t]},this.totalItems+=1;else if("description"==t)this.characteristics[this.totalItems]={key:"M\xf4 t\u1ea3",value:this.mapLayer[t]},this.totalItems+=1;else if("type"==t){let i;0==this.mapLayer[t]?i="L\u1edbp b\u1ea3n \u0111\u1ed3 \u0110\u1ed1i t\u01b0\u1ee3ng":1==this.mapLayer[t]?i="L\u1edbp b\u1ea3n \u0111\u1ed3 S\u1ef1 c\u1ed1":2==this.mapLayer[t]?i="L\u1edbp b\u1ea3n \u0111\u1ed3 Tuy\u1ebfn c\xe1p":3==this.mapLayer[t]?i="\u0110\u1ed9i tu\u1ea7n tra":4==this.mapLayer[t]?i="Tr\u1ea1m s\u1eeda ch\u1eefa":5==this.mapLayer[t]&&(i="Nhi\u1ec7m v\u1ee5"),this.characteristics[this.totalItems]={key:"Ph\xe2n lo\u1ea1i",value:i},this.totalItems+=1}else if("selected"==t){let i;0==this.mapLayer[t]?i="\u0110ang \u1ea9n":1==this.mapLayer[t]&&(i="\u0110ang hi\u1ec3n th\u1ecb"),this.characteristics[this.totalItems]={key:"Hi\u1ec3n th\u1ecb",value:i},this.totalItems+=1}else"createdAt"==t?(this.characteristics[this.totalItems]={key:"Th\u1eddi gian t\u1ea1o",value:this.convertTime(this.mapLayer[t])},this.totalItems+=1):"updatedAt"==t&&(this.characteristics[this.totalItems]={key:"C\u1eadp nh\u1eadt",value:this.convertTime(this.mapLayer[t])},this.totalItems+=1)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Qsj))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-map-layer-info"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Z,5,e.SBq),e.Gf(S,5,e.SBq),e.Gf($,5,e.SBq)),2&t){let s;e.iGM(s=e.CRH())&&(i.divBound=s.first),e.iGM(s=e.CRH())&&(i.divTable=s.first),e.iGM(s=e.CRH())&&(i.divPaginator=s.first)}},inputs:{mapLayer:"mapLayer"},decls:17,vars:11,consts:[[1,"absolute","top-0","left-0","bottom-0","right-0"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["divTable",""],["styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"value","scrollable"],["pTemplate","header"],["pTemplate","body"],[1,"absolute","bottom-0","left-0","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-1","flex","align-items-center"],[1,"col-12","md:col-8","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-3","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text","m-0","p-1",3,"click"],[1,"ml-1"],[2,"width","60px","max-width","60px"],[2,"min-width","200px"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0,1)(2,"div",2,3)(4,"p-table",4),e.YNc(5,O,7,0,"ng-template",5),e.YNc(6,v,7,3,"ng-template",6),e.qZA()(),e.TgZ(7,"div",7,8)(9,"div",9),e._UZ(10,"div",10),e.TgZ(11,"div",11)(12,"p-paginator",12),e.NdJ("onPageChange",function(I){return i.onPageChange(I)}),e.qZA()(),e.TgZ(13,"div",13)(14,"button",14),e.NdJ("click",function(){return i.onReSync()}),e.qZA(),e.TgZ(15,"span",15),e._uU(16),e.qZA()()()()()),2&t&&(e.xp6(4),e.Q6J("value",i.characteristics)("scrollable",!0),e.xp6(8),e.Q6J("rows",i.itemsPerPage)("totalRecords",i.totalItems)("rowsPerPageOptions",e.DdM(10,m))("showJumpToPageDropdown",!0)("showPageLinks",!1),e.xp6(4),e.lnq("Hi\u1ec3n th\u1ecb ",(i.currentPage-1)*i.itemsPerPage+1,"-",(i.currentPage-1)*i.itemsPerPage+i.itemsPerPage>i.totalItems?i.totalItems:(i.currentPage-1)*i.itemsPerPage+i.itemsPerPage,"/",i.totalItems,""))},directives:[U.iA,o.jx,k.D,a.Hq,p.H],styles:[""]}),n})();var L=_(8215),g=_(97);const w=["divBound"],E=["divTable"],D=["divPaginator"];function H(n,h){1&n&&(e.TgZ(0,"tr")(1,"th",23),e._uU(2,"#"),e.qZA(),e._UZ(3,"th",23),e.TgZ(4,"th",24),e._uU(5,"T\xean "),e._UZ(6,"p-sortIcon",25),e.qZA(),e.TgZ(7,"th",24),e._uU(8,"M\xf4 t\u1ea3"),e.qZA(),e.TgZ(9,"th",26),e._uU(10,"Lo\u1ea1i"),e.qZA()())}function N(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u0110\u1ed1i t\u01b0\u1ee3ng"),e.qZA())}function J(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"S\u1ef1 c\u1ed1"),e.qZA())}function G(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"Tuy\u1ebfn c\xe1p"),e.qZA())}function Q(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u0110\u1ed9i tu\u1ea7n tra"),e.qZA())}function V(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"Tr\u1ea1m s\u1eeda ch\u1eefa"),e.qZA())}function K(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"Nhi\u1ec7m v\u1ee5"),e.qZA())}const j=function(n){return{"background-color":n}};function Y(n,h){if(1&n&&(e.TgZ(0,"tr",27)(1,"td",23),e._uU(2),e.qZA(),e.TgZ(3,"td",23),e._UZ(4,"p-tableRadioButton",28),e.qZA(),e.TgZ(5,"td",24),e._uU(6),e.qZA(),e.TgZ(7,"td",24),e._uU(8),e.qZA(),e.TgZ(9,"td",26),e.YNc(10,N,2,0,"span",29),e.YNc(11,J,2,0,"span",29),e.YNc(12,G,2,0,"span",29),e.YNc(13,Q,2,0,"span",29),e.YNc(14,V,2,0,"span",29),e.YNc(15,K,2,0,"span",29),e.qZA()()),2&n){const t=h.$implicit,i=h.rowIndex,s=e.oxw();e.Q6J("ngStyle",e.VKq(12,j,s.isIn(t))),e.xp6(2),e.Oqu((s.currentPage-1)*s.itemsPerPage+1+i),e.xp6(2),e.Q6J("value",t)("disabled",s.isDisabled(t)),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Q6J("ngIf",0===t.type),e.xp6(1),e.Q6J("ngIf",1===t.type),e.xp6(1),e.Q6J("ngIf",2===t.type),e.xp6(1),e.Q6J("ngIf",3===t.type),e.xp6(1),e.Q6J("ngIf",4===t.type),e.xp6(1),e.Q6J("ngIf",5===t.type)}}function W(n,h){1&n&&(e._UZ(0,"i",32),e.TgZ(1,"span",33),e._uU(2,"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o m\u1ee5c n\xe0y!"),e.qZA())}function te(n,h){1&n&&(e.TgZ(0,"p-messages",30),e.YNc(1,W,3,0,"ng-template",31),e.qZA())}const ee=function(){return[15,20,30,50]};let ae=(()=>{class n{constructor(t,i,s,I,F,X){this.ref=t,this.config=i,this.mlHttpService=s,this.messageService=I,this.renderer=F,this.router=X,this.title="Ch\u1ecdn L\u1edbp b\u1ea3n \u0111\u1ed3",this.mapLayerIns=[],this.mapLayers=[],this.selectedMapLayers=[],this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.loading=!1}ngOnDestroy(){this.loadingTime&&clearTimeout(this.loadingTime)}ngAfterViewInit(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight-40}px`)}onWindowResize(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight-40}px`)}ngOnInit(){this.config.data&&(this.mapLayerIns=this.config.data.mapLayerIns,this.type=this.config.data.type,this.fetchListOfMapLayers())}fetchListOfMapLayers(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.mlHttpService.getList(this.type,this.itemsPerPage,this.offset).subscribe({next:t=>{0===t.status?(this.mapLayers=t.data.rows,this.totalItems=t.data.count,this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime),this.selectedMapLayers=[],this.loadStatus()):2===t.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${t.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t.message),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime))},error:t=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}loadStatus(){this.mapLayers.forEach(t=>{t.is_used=!1,this.mapLayerIns.find(i=>i.id==t.id)&&(t.is_used=!0)})}onPageChange(t){this.currentPage=t.page+1,this.itemsPerPage=t.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.fetchListOfMapLayers()}onReSync(){this.fetchListOfMapLayers()}onSubmit(){this.ref.close(this.selectedMapLayers)}onDestroy(){this.ref.destroy()}isRowSelectable(t){return!t.data.is_used}isDisabled(t){return!!t.is_used}isIn(t){return this.mapLayerIns.find(i=>i.id==t.id)?"#cae6fc":null}onComeback(){localStorage.removeItem(L.o.USER),sessionStorage.removeItem(L.o.ACC),this.router.navigate(["/come-back"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(B.E7),e.Y36(B.S),e.Y36(l.z),e.Y36(o.ez),e.Y36(e.Qsj),e.Y36(y.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-pick-map-layer"]],viewQuery:function(t,i){if(1&t&&(e.Gf(w,5,e.SBq),e.Gf(E,5,e.SBq),e.Gf(D,5,e.SBq)),2&t){let s;e.iGM(s=e.CRH())&&(i.divBound=s.first),e.iGM(s=e.CRH())&&(i.divTable=s.first),e.iGM(s=e.CRH())&&(i.divPaginator=s.first)}},decls:26,vars:17,consts:[[1,"absolute","top-0","left-0","bottom-0","right-0",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],[1,"flex","align-items-center","justify-content-between","border-bottom-1","border-gray-300"],[1,"ml-2","text-xl","font-bold"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-danger","p-button-text",3,"click"],[1,"page-content"],["divTable",""],["styleClass","p-datatable-sm p-datatable-striped","dataKey","id","scrollHeight","flex",3,"value","selection","selectionPageOnly","rowSelectable","scrollable","loading","selectionChange"],["pTemplate","header"],["pTemplate","body"],[1,"absolute","bottom-0","left-0","w-full","p-1","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-5","flex","align-items-center"],["pButton","","pRipple","","type","button","label","Ch\u1ecdn","icon","fa-solid fa-check",1,"mr-1",3,"disabled","click"],["pButton","","pRipple","","type","button","label","H\u1ee7y b\u1ecf","icon","fa-solid fa-times",1,"p-button-outlined","mr-1",3,"click"],[1,"col-12","md:col-5","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-2","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text",3,"click"],[1,"ml-1"],["noPermission",""],[2,"width","60px","max-width","60px"],[2,"min-width","300px"],["field","name"],[2,"min-width","150px"],[3,"ngStyle"],[3,"value","disabled"],[4,"ngIf"],["severity","error"],["pTemplate",""],[1,"pi","pi-times-circle"],[1,"ml-2"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0,1),e.NdJ("resize",function(){return i.onWindowResize()},!1,e.Jf7),e.TgZ(2,"div",2)(3,"div",3)(4,"span",4),e._uU(5),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){return i.onDestroy()}),e.qZA()(),e.TgZ(7,"div",6,7)(9,"p-table",8),e.NdJ("selectionChange",function(I){return i.selectedMapLayers=I}),e.YNc(10,H,11,0,"ng-template",9),e.YNc(11,Y,16,14,"ng-template",10),e.qZA()()(),e.TgZ(12,"div",11,12)(14,"div",13)(15,"div",14)(16,"button",15),e.NdJ("click",function(){return i.onSubmit()}),e.qZA(),e.TgZ(17,"button",16),e.NdJ("click",function(){return i.onDestroy()}),e.qZA()(),e.TgZ(18,"div",17)(19,"p-paginator",18),e.NdJ("onPageChange",function(I){return i.onPageChange(I)}),e.qZA()(),e.TgZ(20,"div",19)(21,"button",20),e.NdJ("click",function(){return i.onReSync()}),e.qZA(),e.TgZ(22,"span",21),e._uU(23),e.qZA()()()()(),e.YNc(24,te,2,0,"ng-template",null,22,e.W1O)),2&t&&(e.xp6(5),e.Oqu(i.title),e.xp6(4),e.Q6J("value",i.mapLayers)("selection",i.selectedMapLayers)("selectionPageOnly",!0)("rowSelectable",i.isRowSelectable)("scrollable",!0)("loading",i.loading),e.xp6(7),e.Q6J("disabled",0==i.selectedMapLayers.length),e.xp6(3),e.Q6J("rows",i.itemsPerPage)("totalRecords",i.totalItems)("rowsPerPageOptions",e.DdM(16,ee))("showJumpToPageDropdown",!0)("showPageLinks",!1),e.xp6(4),e.lnq("Displaying ",(i.currentPage-1)*i.itemsPerPage+1,"-",(i.currentPage-1)*i.itemsPerPage+i.itemsPerPage>i.totalItems?i.totalItems:(i.currentPage-1)*i.itemsPerPage+i.itemsPerPage," of ",i.totalItems,""))},directives:[a.Hq,p.H,U.iA,o.jx,U.fz,c.PC,U.GE,c.O5,k.D,g.V],styles:[""]}),n})();var se=_(6015),oe=_(6180),ne=_(1208),re=_(4119);const le=["divBound"],pe=["divTable"],de=["divPaginator"];function ce(n,h){1&n&&(e.TgZ(0,"tr")(1,"th",18),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",19),e._uU(4,"T\xean"),e.qZA(),e.TgZ(5,"th",20),e._uU(6,"Thao t\xe1c"),e.qZA()())}function ue(n,h){if(1&n){const t=e.EpF();e.TgZ(0,"tr",21)(1,"td",18),e._uU(2),e.qZA(),e.TgZ(3,"td",19),e._uU(4),e.qZA(),e.TgZ(5,"td",20)(6,"p-checkbox",22),e.NdJ("ngModelChange",function(s){return e.CHM(t).$implicit.is_displayed_on_map_checked=s})("onChange",function(s){const F=e.CHM(t).$implicit;return e.oxw().onChangeDisplayInside(s,F.id)}),e.qZA()()()}if(2&n){const t=h.$implicit,i=h.rowIndex,s=e.oxw();e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu((s.currentPage-1)*s.itemsPerPage+1+i),e.xp6(2),e.AsE("",t.name," (#",t.id,")"),e.xp6(2),e.Q6J("ngModel",t.is_displayed_on_map_checked)("binary",!0)("disabled",1===s.mapLayer.type)}}function me(n,h){1&n&&(e.TgZ(0,"div",23),e._uU(1," Kh\xf4ng c\xf3 d\u1eef li\u1ec7u trong m\u1ee5c n\xe0y. "),e.qZA())}function he(n,h){if(1&n){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw().onChangeMaplayer()}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",!t.currentDevice)}}const ge=function(){return[15,20,30,50]};let fe=(()=>{class n{constructor(t,i,s,I,F,X,ie,Xe){this.mlHttpService=t,this.dHttpService=i,this.tHttpService=s,this.messageService=I,this.renderer=F,this.dialogService=X,this.permissionService=ie,this.router=Xe,this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.listInsides=[],this.loading=!1}ngOnDestroy(){this.subPermission&&this.subPermission.unsubscribe(),this.loadingTime&&clearTimeout(this.loadingTime)}ngOnChanges(t){let i=t.mapLayer;i&&i.currentValue&&this.fetchListInside()}setStyleDiv(){this.windowWidth=this.divBound.nativeElement.offsetWidth,this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight}px`)}ngAfterViewInit(){this.setStyleDiv()}onWindowResize(){this.setStyleDiv()}ngOnInit(){this.subPermission=this.permissionService.currentPermission.subscribe(t=>{t&&(this.permission=t)})}fetchListInside(){0===this.mapLayer.type?this.fetchDeviceInside():1===this.mapLayer.type&&this.fetchTroubleInside()}fetchDeviceInside(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.mlHttpService.getListDeviceOnMapLayer(this.mapLayer.id,this.itemsPerPage,this.offset).subscribe({next:t=>{0===t.status?(this.listInsides=t.data.rows,this.totalItems=t.data.count,this.loadChecked(this.listInsides),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)):2===t.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${t.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t.message),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime))},error:t=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}loadChecked(t){t.forEach(i=>{i.is_displayed_on_map_checked=!!i.is_displayed_on_map})}fetchTroubleInside(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.mlHttpService.getListTroubleOfMap(this.mapLayer.id,this.itemsPerPage,this.offset).subscribe({next:t=>{0===t.status?(this.listInsides=t.data.rows,this.totalItems=t.data.count,this.loadChecked(this.listInsides),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)):2===t.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${t.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t.message),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime))},error:t=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}onPageChange(t){this.currentPage=t.page+1,this.itemsPerPage=t.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.fetchListInside()}onReSync(){this.fetchListInside()}onChangeDisplayInside(t,i){0===this.mapLayer.type?this.onChangeDisplayDeviceInside(i,t.checked):1===this.mapLayer.type&&this.onChangeDisplayTroubleInside(i,t.checked)}onChangeDisplayDeviceInside(t,i){this.dHttpService.editInfo({id:t,is_displayed_on_map:i?1:0}).subscribe({next:s=>{0===s.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:`\u0110\xe3 ${i?"hi\u1ec7n":"\u1ea9n"} thi\u1ebft b\u1ecb th\xe0nh c\xf4ng`}),this.fetchListInside()):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${s.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",s.message))},error:s=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",s)}})}onChangeDisplayTroubleInside(t,i){this.tHttpService.editTroubleDisplayOnMap(t,i?1:0).subscribe({next:s=>{0===s.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:`\u0110\xe3 ${i?"hi\u1ec7n":"\u1ea9n"} s\u1ef1 c\u1ed1 th\xe0nh c\xf4ng`}),this.fetchListInside()):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${s.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",s.message))},error:s=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",s)}})}onChangeMaplayer(){0===this.mapLayer.type&&this.changeMapLayerForDevice()}changeMapLayerForDevice(){this.dialogService.open(ae,{data:{mapLayerIns:[this.mapLayer],type:this.mapLayer.type},showHeader:!1,height:"99vh",width:"99vw",contentStyle:{padding:"0",margin:0}}).onClose.subscribe(i=>{i&&this.dHttpService.editInfo({id:this.currentDevice.id,map_id:i.id}).subscribe({next:s=>{0===s.status?(this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 thay \u0111\u1ed5i l\u1edbp b\u1ea3n \u0111\u1ed3 cho thi\u1ebft b\u1ecb th\xe0nh c\xf4ng"}),this.fetchListInside()):2===s.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${s.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",s.message))},error:s=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",s)}})})}onComeback(){localStorage.removeItem(L.o.USER),sessionStorage.removeItem(L.o.ACC),this.router.navigate(["/come-back"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.z),e.Y36(se.x),e.Y36(oe.R),e.Y36(o.ez),e.Y36(e.Qsj),e.Y36(B.xA),e.Y36(P.$),e.Y36(y.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-map-layer-inside"]],viewQuery:function(t,i){if(1&t&&(e.Gf(le,5,e.SBq),e.Gf(pe,5,e.SBq),e.Gf(de,5,e.SBq)),2&t){let s;e.iGM(s=e.CRH())&&(i.divBound=s.first),e.iGM(s=e.CRH())&&(i.divTable=s.first),e.iGM(s=e.CRH())&&(i.divPaginator=s.first)}},inputs:{mapLayer:"mapLayer"},features:[e.TTD],decls:19,vars:14,consts:[[1,"relative","h-full","w-full",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["divTable",""],["selectionMode","single","styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"value","selection","scrollable","loading","selectionChange"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"absolute","bottom-0","left-0","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-5","flex","align-items-center"],["pButton","","pRipple","","type","button","label","Chuy\u1ec3n l\u1edbp","icon","pi pi-directions","class","mx-1","pTooltip","Chuy\u1ec3n sang l\u1edbp b\u1ea3n \u0111\u1ed3 kh\xe1c","tooltipPosition","top",3,"disabled","click",4,"ngIf"],[1,"col-12","md:col-5","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-2","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text","m-0","p-1",3,"click"],[1,"ml-1"],[2,"width","60px","max-width","60px"],[2,"min-width","300px"],[2,"min-width","200px"],[3,"pSelectableRow"],["inputId","binary",3,"ngModel","binary","disabled","ngModelChange","onChange"],[1,"p-fluid","p-2"],["pButton","","pRipple","","type","button","label","Chuy\u1ec3n l\u1edbp","icon","pi pi-directions","pTooltip","Chuy\u1ec3n sang l\u1edbp b\u1ea3n \u0111\u1ed3 kh\xe1c","tooltipPosition","top",1,"mx-1",3,"disabled","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0,1),e.NdJ("resize",function(){return i.onWindowResize()},!1,e.Jf7),e.TgZ(2,"div",2,3)(4,"p-table",4),e.NdJ("selectionChange",function(I){return i.currentDevice=I}),e.YNc(5,ce,7,0,"ng-template",5),e.YNc(6,ue,7,7,"ng-template",6),e.YNc(7,me,2,0,"ng-template",7),e.qZA()(),e.TgZ(8,"div",8,9)(10,"div",10)(11,"div",11),e.YNc(12,he,1,1,"button",12),e.qZA(),e.TgZ(13,"div",13)(14,"p-paginator",14),e.NdJ("onPageChange",function(I){return i.onPageChange(I)}),e.qZA()(),e.TgZ(15,"div",15)(16,"button",16),e.NdJ("click",function(){return i.onReSync()}),e.qZA(),e.TgZ(17,"span",17),e._uU(18),e.qZA()()()()()),2&t&&(e.xp6(4),e.Q6J("value",i.listInsides)("selection",i.currentDevice)("scrollable",!0)("loading",i.loading),e.xp6(8),e.Q6J("ngIf",i.permission.editor_map_layer.change_display&&i.mapLayer&&0===i.mapLayer.type),e.xp6(2),e.Q6J("rows",i.itemsPerPage)("totalRecords",i.totalItems)("rowsPerPageOptions",e.DdM(13,ge))("showJumpToPageDropdown",!0)("showPageLinks",!1),e.xp6(4),e.lnq("Hi\u1ec3n th\u1ecb ",(i.currentPage-1)*i.itemsPerPage+1,"-",(i.currentPage-1)*i.itemsPerPage+i.itemsPerPage>i.totalItems?i.totalItems:(i.currentPage-1)*i.itemsPerPage+i.itemsPerPage,"/",i.totalItems,""))},directives:[U.iA,o.jx,U.Ei,ne.XZ,b.JJ,b.On,c.O5,a.Hq,p.H,re.u,k.D],styles:[""]}),n})();const _e=["divBound"],ye=["divHeader"],ve=["divTable"];function be(n,h){if(1&n&&e._UZ(0,"app-map-layer-info",13),2&n){const t=e.oxw(2);e.Q6J("mapLayer",t.mapLayer)}}function Ce(n,h){if(1&n&&e._UZ(0,"app-map-layer-inside",13),2&n){const t=e.oxw(2);e.Q6J("mapLayer",t.mapLayer)}}function Le(n,h){if(1&n){const t=e.EpF();e.TgZ(0,"div",2,3),e.NdJ("resize",function(){return e.CHM(t),e.oxw().onWindowResize()},!1,e.Jf7),e.TgZ(2,"div",4,5)(4,"div",6)(5,"span",7),e._uU(6),e.qZA(),e.TgZ(7,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().onDestroy()}),e.qZA()(),e._UZ(8,"p-tabMenu",9),e.qZA(),e.TgZ(9,"div",10,11),e.YNc(11,be,1,1,"app-map-layer-info",12),e.YNc(12,Ce,1,1,"app-map-layer-inside",12),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(6),e.Oqu(t.title),e.xp6(2),e.Q6J("model",t.tabs)("activeItem",t.activeTab),e.xp6(3),e.Q6J("ngIf",1==t.tabIndex),e.xp6(1),e.Q6J("ngIf",2==t.tabIndex)}}function Te(n,h){1&n&&(e._UZ(0,"i",16),e.TgZ(1,"span",17),e._uU(2,"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o m\u1ee5c n\xe0y!"),e.qZA())}function Me(n,h){1&n&&(e.TgZ(0,"p-messages",14),e.YNc(1,Te,3,0,"ng-template",15),e.qZA())}let Ee=(()=>{class n{constructor(t,i,s,I){this.renderer=t,this.permissionService=i,this.ref=s,this.config=I,this.tabIndex=1,this.title="Chi ti\u1ebft L\u1edbp b\u1ea3n \u0111\u1ed3"}ngOnDestroy(){this.subPermission&&this.subPermission.unsubscribe()}setStyleDiv(){this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divHeader.nativeElement.offsetHeight}px`)}ngAfterViewInit(){this.setStyleDiv()}onWindowResize(){this.setStyleDiv()}ngOnInit(){this.subPermission=this.permissionService.currentPermission.subscribe(t=>{t&&(this.permission=t,this.initForm(),this.config.data&&(this.mapLayer=this.config.data.mapLayer))})}initForm(){this.tabs=[{label:"Th\xf4ng tin",command:()=>{this.tabIndex=1}},{label:"Danh s\xe1ch",command:()=>{this.tabIndex=2}}],this.activeTab=this.tabs[0],this.tabIndex=1}onDestroy(){this.ref.destroy()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Qsj),e.Y36(P.$),e.Y36(B.E7),e.Y36(B.S))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-map-layer-detail"]],viewQuery:function(t,i){if(1&t&&(e.Gf(_e,5,e.SBq),e.Gf(ye,5,e.SBq),e.Gf(ve,5,e.SBq)),2&t){let s;e.iGM(s=e.CRH())&&(i.divBound=s.first),e.iGM(s=e.CRH())&&(i.divHeader=s.first),e.iGM(s=e.CRH())&&(i.divTable=s.first)}},decls:3,vars:2,consts:[["class","absolute top-0 left-0 bottom-0 right-0",3,"resize",4,"ngIf","ngIfElse"],["noPermission",""],[1,"absolute","top-0","left-0","bottom-0","right-0",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["divHeader",""],[1,"flex","align-items-center","justify-content-between","border-bottom-1","border-gray-300"],[1,"ml-2","text-xl","font-bold"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-danger","p-button-text",3,"click"],[3,"model","activeItem"],[1,"absolute","bottom-0","left-0","w-full"],["divTable",""],[3,"mapLayer",4,"ngIf"],[3,"mapLayer"],["severity","error"],["pTemplate",""],[1,"pi","pi-times-circle"],[1,"ml-2"]],template:function(t,i){if(1&t&&(e.YNc(0,Le,13,5,"div",0),e.YNc(1,Me,2,0,"ng-template",null,1,e.W1O)),2&t){const s=e.MAs(2);e.Q6J("ngIf",i.permission.device_script.self)("ngIfElse",s)}},directives:[c.O5,a.Hq,p.H,M.d,d,fe,g.V,o.jx],styles:[""]}),n})();var we=_(9269),xe=_(7658),Se=_(9955);const Pe=["divBound"],Ae=["divTable"],Ze=["divPaginator"];function $e(n,h){if(1&n){const t=e.EpF();e.TgZ(0,"div",28)(1,"span",29),e._uU(2,"L\u1ecdc theo:"),e.qZA(),e.TgZ(3,"p-dropdown",30),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw(2).type=s})("onChange",function(){return e.CHM(t),e.oxw(2).onChangeType()}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("options",t.typeOptions)("ngModel",t.type)}}function De(n,h){1&n&&(e.TgZ(0,"tr")(1,"th",31),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",32),e._uU(4,"T\xean "),e._UZ(5,"p-sortIcon",33),e.qZA(),e.TgZ(6,"th",34),e._uU(7,"M\xf4 t\u1ea3"),e.qZA(),e.TgZ(8,"th",35),e._uU(9,"Lo\u1ea1i"),e.qZA(),e.TgZ(10,"th",35),e._uU(11,"Hi\u1ec3n th\u1ecb"),e.qZA(),e.TgZ(12,"th",36),e._uU(13,"Th\u1eddi gian t\u1ea1o "),e._UZ(14,"p-sortIcon",37),e.qZA(),e.TgZ(15,"th",38),e._uU(16,"C\u1eadp nh\u1eadt "),e._UZ(17,"p-sortIcon",39),e.qZA()())}function Ie(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u0110\u1ed1i t\u01b0\u1ee3ng"),e.qZA())}function Ue(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"S\u1ef1 c\u1ed1"),e.qZA())}function Be(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"Tuy\u1ebfn c\xe1p"),e.qZA())}function Oe(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u0110\u1ed9i tu\u1ea7n tra"),e.qZA())}function Re(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"Tr\u1ea1m s\u1eeda ch\u1eefa"),e.qZA())}function Ne(n,h){1&n&&(e.TgZ(0,"span"),e._uU(1,"Nhi\u1ec7m v\u1ee5"),e.qZA())}function He(n,h){if(1&n){const t=e.EpF();e.TgZ(0,"tr",40)(1,"td",31),e._uU(2),e.qZA(),e.TgZ(3,"td",41),e._uU(4),e.qZA(),e.TgZ(5,"td",34),e._uU(6),e.qZA(),e.TgZ(7,"td",35),e.YNc(8,Ie,2,0,"span",42),e.YNc(9,Ue,2,0,"span",42),e.YNc(10,Be,2,0,"span",42),e.YNc(11,Oe,2,0,"span",42),e.YNc(12,Re,2,0,"span",42),e.YNc(13,Ne,2,0,"span",42),e.qZA(),e.TgZ(14,"td",35)(15,"p-checkbox",43),e.NdJ("ngModelChange",function(s){return e.CHM(t).$implicit.is_displayed=s})("onChange",function(s){const F=e.CHM(t).$implicit;return e.oxw(2).onChangeDisplay(s,F)}),e.qZA()(),e.TgZ(16,"td",44),e._uU(17),e.qZA(),e.TgZ(18,"td",44),e._uU(19),e.qZA()()}if(2&n){const t=h.$implicit,i=h.rowIndex,s=e.oxw(2);e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu((s.currentPage-1)*s.itemsPerPage+1+i),e.xp6(2),e.AsE("",t.name," (#",t.id,")"),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Q6J("ngIf",0===t.type),e.xp6(1),e.Q6J("ngIf",1===t.type),e.xp6(1),e.Q6J("ngIf",2===t.type),e.xp6(1),e.Q6J("ngIf",3===t.type),e.xp6(1),e.Q6J("ngIf",4===t.type),e.xp6(1),e.Q6J("ngIf",5===t.type),e.xp6(2),e.Q6J("ngModel",t.is_displayed)("binary",!0)("disabled",!s.permission.editor_map_layer.change_display),e.xp6(2),e.Oqu(s.convertTime(t.createdAt)),e.xp6(2),e.Oqu(s.convertTime(t.updatedAt))}}function ke(n,h){1&n&&(e.TgZ(0,"div",45),e._uU(1," Kh\xf4ng c\xf3 d\u1eef li\u1ec7u trong m\u1ee5c n\xe0y. "),e.qZA())}function qe(n,h){if(1&n){const t=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).onAdd()}),e.qZA()}}function Je(n,h){if(1&n){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).onEdit()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.currentMapLayer)}}function Ye(n,h){if(1&n){const t=e.EpF();e.TgZ(0,"p-splitButton",48),e.NdJ("onClick",function(){return e.CHM(t),e.oxw(2).onViewDetail()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("showTransitionOptions","200ms")("hideTransitionOptions","200ms")("model",t.moreCommands)("disabled",!t.currentMapLayer)}}const Fe=function(){return[15,20,30,50]};function Qe(n,h){if(1&n){const t=e.EpF();e.TgZ(0,"div",2,3),e.NdJ("resize",function(){return e.CHM(t),e.oxw().onWindowResize()},!1,e.Jf7),e.TgZ(2,"div",4),e._UZ(3,"p-breadcrumb",5),e.TgZ(4,"div",6)(5,"h3",7),e._UZ(6,"i",8),e._uU(7,"Qu\u1ea3n l\xfd L\u1edbp b\u1ea3n \u0111\u1ed3 "),e.qZA()(),e.TgZ(8,"div",9,10)(10,"p-table",11),e.NdJ("selectionChange",function(s){return e.CHM(t),e.oxw().currentMapLayer=s})("onRowSelect",function(s){return e.CHM(t),e.oxw().onRowSelect(s)})("onRowUnselect",function(s){return e.CHM(t),e.oxw().onRowUnselect(s)}),e.YNc(11,$e,4,2,"ng-template",12),e.YNc(12,De,18,0,"ng-template",13),e.YNc(13,He,20,16,"ng-template",14),e.YNc(14,ke,2,0,"ng-template",15),e.qZA()()(),e.TgZ(15,"div",16,17)(17,"div",18)(18,"div",19),e.YNc(19,qe,1,0,"button",20),e.YNc(20,Je,1,1,"button",21),e.YNc(21,Ye,1,4,"p-splitButton",22),e.qZA(),e.TgZ(22,"div",23)(23,"p-paginator",24),e.NdJ("onPageChange",function(s){return e.CHM(t),e.oxw().onPageChange(s)}),e.qZA()(),e.TgZ(24,"div",25)(25,"button",26),e.NdJ("click",function(){return e.CHM(t),e.oxw().onReSync()}),e.qZA(),e.TgZ(26,"span",27),e._uU(27),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("model",t.pathLinks)("home",t.homeLink),e.xp6(7),e.Q6J("selection",t.currentMapLayer)("value",t.mapLayers)("scrollable",!0)("loading",t.loading),e.xp6(9),e.Q6J("ngIf",t.permission.editor_map_layer.create),e.xp6(1),e.Q6J("ngIf",t.permission.editor_map_layer.edit),e.xp6(1),e.Q6J("ngIf",t.permission.editor_map_layer.self),e.xp6(2),e.Q6J("rows",t.itemsPerPage)("totalRecords",t.totalItems)("rowsPerPageOptions",e.DdM(17,Fe))("showJumpToPageDropdown",!0)("showPageLinks",!1),e.xp6(4),e.lnq("Hi\u1ec3n th\u1ecb ",(t.currentPage-1)*t.itemsPerPage+1,"-",(t.currentPage-1)*t.itemsPerPage+t.itemsPerPage>t.totalItems?t.totalItems:(t.currentPage-1)*t.itemsPerPage+t.itemsPerPage,"/",t.totalItems,"")}}function Ge(n,h){1&n&&(e._UZ(0,"i",56),e.TgZ(1,"span",57),e._uU(2,"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp v\xe0o m\u1ee5c n\xe0y!"),e.qZA())}function We(n,h){if(1&n){const t=e.EpF();e.TgZ(0,"div",49)(1,"p-messages",50),e.YNc(2,Ge,3,0,"ng-template",51),e.qZA()(),e.TgZ(3,"div",52)(4,"div",53),e.NdJ("click",function(){return e.CHM(t),e.oxw().onGoBackHome()}),e._UZ(5,"span",54),e.TgZ(6,"span",55),e._uU(7,"Quay l\u1ea1i Trang ch\u1ee7"),e.qZA()()()}}const ze=[{path:"",component:(()=>{class n{constructor(t,i,s,I,F,X,ie){this.mlHttpService=t,this.messageService=i,this.renderer=s,this.confirmService=I,this.dialogService=F,this.permissionService=X,this.router=ie,this.offset=0,this.totalItems=0,this.itemsPerPage=15,this.currentPage=1,this.mapLayers=[],this.typeOptions=[{name:"T\u1ea5t c\u1ea3",value:void 0},{name:"L\u1edbp b\u1ea3n \u0111\u1ed3 \u0110\u1ed1i t\u01b0\u1ee3ng",value:0},{name:"L\u1edbp b\u1ea3n \u0111\u1ed3 S\u1ef1 c\u1ed1",value:1},{name:"L\u1edbp b\u1ea3n \u0111\u1ed3 Tuy\u1ebfn c\xe1p",value:2},{name:"\u0110\u1ed9i tu\u1ea7n tra",value:3},{name:"Tr\u1ea1m s\u1eeda ch\u1eefa",value:4},{name:"Nhi\u1ec7m v\u1ee5",value:5}],this.loading=!1}ngOnDestroy(){this.subPermission&&this.subPermission.unsubscribe(),this.loadingTime&&clearTimeout(this.loadingTime)}setStyleDiv(){this.windowWidth=this.divBound.nativeElement.offsetWidth,this.renderer.setStyle(this.divTable.nativeElement,"height",`  ${this.divBound.nativeElement.offsetHeight-this.divPaginator.nativeElement.offsetHeight-62}px`)}ngAfterViewInit(){this.setStyleDiv()}onWindowResize(){this.setStyleDiv()}calcWidth(){let t="";return t=this.windowWidth<576?.95*this.windowWidth+"px":this.windowWidth>=576&&this.windowWidth<768?.55*this.windowWidth+"px":this.windowWidth>=768&&this.windowWidth<992?.45*this.windowWidth+"px":this.windowWidth>=992&&this.windowWidth<1400?.4*this.windowWidth+"px":.3*this.windowWidth+"px",t}ngOnInit(){this.subPermission=this.permissionService.currentPermission.subscribe(t=>{t&&(this.permission=t,this.initForm(),this.fetchListOfMapLayers())})}initForm(){this.pathLinks=[{label:"Bi\xean t\u1eadp",disabled:!0},{label:"L\u1edbp b\u1ea3n \u0111\u1ed3",disabled:!0}],this.homeLink={icon:"fa-solid fa-home",routerLink:"/"},this.moreCommands=[{label:"X\xf3a b\u1ecf",icon:"fa-solid fa-minus",disabled:!0,command:()=>{this.onDelete()}}]}fetchListOfMapLayers(){this.loadingTime=setTimeout(()=>{this.loading=!0},1e3),this.mlHttpService.getList(this.type,this.itemsPerPage,this.offset).subscribe({next:t=>{0===t.status?(this.mapLayers=t.data.rows,this.totalItems=t.data.count,this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime),this.mapLayers.forEach(i=>i.is_displayed=!!i.selected),this.currentMapLayer=void 0):2===t.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${t.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t.message),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime))},error:t=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",t),this.loading=!1,this.loadingTime&&clearTimeout(this.loadingTime)}})}onRowSelect(t){this.moreCommands[0].disabled=!this.permission.editor_map_layer.delete||!this.currentMapLayer}onRowUnselect(t){this.moreCommands[0].disabled=!this.permission.editor_map_layer.delete||!this.currentMapLayer}onPageChange(t){this.currentPage=t.page+1,this.itemsPerPage=t.rows,this.offset=(this.currentPage-1)*this.itemsPerPage,this.fetchListOfMapLayers()}onReSync(){this.fetchListOfMapLayers()}onChangeType(){this.fetchListOfMapLayers()}onChangeDisplay(t,i){this.mlHttpService.showHideMapLayer(i.id,t.checked?1:0).subscribe({next:s=>{0===s.status?this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:`\u0110\xe3 ${t.checked?"hi\u1ec7n":"\u1ea9n"} L\u1edbp b\u1ea3n \u0111\u1ed3 th\xe0nh c\xf4ng`}):(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${s.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",s.message))},error:s=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",s)}})}onAdd(){this.dialogService.open(C,{showHeader:!1,height:"450px",width:this.calcWidth(),contentStyle:{padding:"0",margin:0}}).onClose.subscribe(()=>{this.fetchListOfMapLayers()})}onEdit(){this.dialogService.open(C,{data:{mapLayer:this.currentMapLayer,title:"C\u1eadp nh\u1eadt L\u1edbp b\u1ea3n \u0111\u1ed3"},showHeader:!1,height:"450px",width:this.calcWidth(),contentStyle:{padding:"0",margin:0}}).onClose.subscribe(()=>{this.fetchListOfMapLayers()})}onViewDetail(){this.dialogService.open(Ee,{data:{mapLayer:this.currentMapLayer},showHeader:!1,width:"99vw",height:"99vh",contentStyle:{padding:"0",margin:0}})}onDelete(){this.confirmService.confirm({message:`B\u1ea1n c\xf3 mu\u1ed1n x\xf3a L\u1edbp b\u1ea3n \u0111\u1ed3 "${this.currentMapLayer.name}" kh\xf4ng?`,header:"X\xe1c nh\u1eadn x\xf3a L\u1edbp b\u1ea3n \u0111\u1ed3",icon:"pi pi-info-circle"}).then(t=>{t&&this.mlHttpService.delete(this.currentMapLayer.id).subscribe({next:i=>{0===i.status?(this.fetchListOfMapLayers(),this.messageService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 x\xf3a L\u1edbp b\u1ea3n \u0111\u1ed3 th\xe0nh c\xf4ng"})):2===i.status?this.onComeback():(this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:`${i.message}`}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i.message))},error:i=>{this.messageService.add({severity:"error",summary:"L\u1ed7i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i"}),console.error("C\xf3 l\u1ed7i x\u1ea3y ra",i)}})}).catch(t=>{})}convertTime(t){return R.I.isoToVnTime(t)}onGoBackHome(){this.router.navigate(["/"])}onComeback(){localStorage.removeItem(L.o.USER),sessionStorage.removeItem(L.o.ACC),this.router.navigate(["/come-back"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.z),e.Y36(o.ez),e.Y36(e.Qsj),e.Y36(we.I),e.Y36(B.xA),e.Y36(P.$),e.Y36(y.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-map-layer-management"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Pe,5,e.SBq),e.Gf(Ae,5,e.SBq),e.Gf(Ze,5,e.SBq)),2&t){let s;e.iGM(s=e.CRH())&&(i.divBound=s.first),e.iGM(s=e.CRH())&&(i.divTable=s.first),e.iGM(s=e.CRH())&&(i.divPaginator=s.first)}},decls:3,vars:2,consts:[["class","relative h-full w-full",3,"resize",4,"ngIf","ngIfElse"],["noPermission",""],[1,"relative","h-full","w-full",3,"resize"],["divBound",""],[1,"absolute","top-0","left-0","w-full"],["styleClass","text-sm p-1",3,"model","home"],[1,"flex","align-items-center"],[1,"text-blue-700","m-0","px-2","pt-2","pb-0"],[1,"fa-solid","fa-list","mr-2"],[1,"page-content","mt-1"],["divTable",""],["selectionMode","single","styleClass","p-datatable-sm p-datatable-striped","scrollHeight","flex",3,"selection","value","scrollable","loading","selectionChange","onRowSelect","onRowUnselect"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"absolute","bottom-0","left-0","w-full","border-top-1","border-gray-300"],["divPaginator",""],[1,"grid","grid-nogutter"],[1,"col-12","md:col-5","flex","align-items-center"],["pButton","","pRipple","","type","button","label","Th\xeam","icon","fa-solid fa-plus","class","mx-1",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","label","Ch\u1ec9nh s\u1eeda","icon","fa-solid fa-pen","class","mr-1",3,"disabled","click",4,"ngIf"],["label","Chi ti\u1ebft","icon","fa-solid fa-wand-sparkles",3,"showTransitionOptions","hideTransitionOptions","model","disabled","onClick",4,"ngIf"],[1,"col-12","md:col-5","flex","align-items-center","justify-content-end"],["styleClass","p-0",3,"rows","totalRecords","rowsPerPageOptions","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"col-12","md:col-2","flex","align-items-center"],["pButton","","pRipple","","type","button","icon","fa-solid fa-sync",1,"p-button-raised","p-button-text","m-0","p-1",3,"click"],[1,"ml-1"],[1,"flex","align-items-center","justify-content-start","m-0","p-0"],[1,"mr-2"],["placeholder","Ch\u1ecdn c\xf4ng t\u01a1","panelStyleClass","text-overflow-ellipsis text-sm","optionLabel","name","optionValue","value",3,"options","ngModel","ngModelChange","onChange"],[2,"width","60px","max-width","60px"],["pSortableColumn","name",2,"min-width","400px"],["field","name"],[2,"min-width","300px"],[2,"min-width","150px"],["pSortableColumn","createdAt",2,"min-width","200px"],["field","createdAt"],["pSortableColumn","updatedAt",2,"min-width","200px"],["field","updatedAt"],[3,"pSelectableRow"],[2,"min-width","400px"],[4,"ngIf"],["inputId","binary",3,"ngModel","binary","disabled","ngModelChange","onChange"],[2,"min-width","200px"],[1,"p-fluid","p-2"],["pButton","","pRipple","","type","button","label","Th\xeam","icon","fa-solid fa-plus",1,"mx-1",3,"click"],["pButton","","pRipple","","type","button","label","Ch\u1ec9nh s\u1eeda","icon","fa-solid fa-pen",1,"mr-1",3,"disabled","click"],["label","Chi ti\u1ebft","icon","fa-solid fa-wand-sparkles",3,"showTransitionOptions","hideTransitionOptions","model","disabled","onClick"],[1,"flex","align-items-center","justify-content-center"],["severity","error"],["pTemplate",""],[1,"flex","align-items-center","justify-content-center","cursor-pointer"],["pRipple","",1,"flex","align-items-center","justify-content-center","w-full","h-4rem","max-w-20rem","bg-blue-500","border-round-md","shadow-8","text-white","font-bold",3,"click"],[1,"fa-solid","fa-home"],[1,"text-center","text-xl","mx-2"],[1,"pi","pi-times-circle"],[1,"ml-2"]],template:function(t,i){if(1&t&&(e.YNc(0,Qe,28,18,"div",0),e.YNc(1,We,8,0,"ng-template",null,1,e.W1O)),2&t){const s=e.MAs(2);e.Q6J("ngIf",i.permission.editor_map_layer.self)("ngIfElse",s)}},directives:[c.O5,xe.a,U.iA,o.jx,r.Lt,b.JJ,b.On,U.lQ,U.fz,U.Ei,ne.XZ,a.Hq,p.H,Se.a,k.D,g.V],styles:[""]}),n})()}];let je=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[y.Bz.forChild(ze)],y.Bz]}),n})();var Ve=_(4695);let Ke=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[c.ez,je,Ve.m]]}),n})()},1764:function(z){z.exports=function(){"use strict";var _=6e4,c=36e5,y="millisecond",e="second",R="minute",b="hour",B="day",l="week",o="month",a="quarter",p="year",u="date",r="Invalid Date",x=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(v){var m=["th","st","nd","rd"],d=v%100;return"["+v+(m[(d-20)%10]||m[d]||m[0])+"]"}},T=function(v,m,d){var L=String(v);return!L||L.length>=m?v:""+Array(m+1-L.length).join(d)+v},C={s:T,z:function(v){var m=-v.utcOffset(),d=Math.abs(m),L=Math.floor(d/60),g=d%60;return(m<=0?"+":"-")+T(L,2,"0")+":"+T(g,2,"0")},m:function v(m,d){if(m.date()<d.date())return-v(d,m);var L=12*(d.year()-m.year())+(d.month()-m.month()),g=m.clone().add(L,o),w=d-g<0,E=m.clone().add(L+(w?-1:1),o);return+(-(L+(d-g)/(w?g-E:E-g))||0)},a:function(v){return v<0?Math.ceil(v)||0:Math.floor(v)},p:function(v){return{M:o,y:p,w:l,d:B,D:u,h:b,m:R,s:e,ms:y,Q:a}[v]||String(v||"").toLowerCase().replace(/s$/,"")},u:function(v){return void 0===v}},P="en",M={};M[P]=f;var U=function(v){return v instanceof $},k=function v(m,d,L){var g;if(!m)return P;if("string"==typeof m){var w=m.toLowerCase();M[w]&&(g=w),d&&(M[w]=d,g=w);var E=m.split("-");if(!g&&E.length>1)return v(E[0])}else{var D=m.name;M[D]=m,g=D}return!L&&g&&(P=g),g||!L&&P},Z=function(v,m){if(U(v))return v.clone();var d="object"==typeof m?m:{};return d.date=v,d.args=arguments,new $(d)},S=C;S.l=k,S.i=U,S.w=function(v,m){return Z(v,{locale:m.$L,utc:m.$u,x:m.$x,$offset:m.$offset})};var $=function(){function v(d){this.$L=k(d.locale,null,!0),this.parse(d)}var m=v.prototype;return m.parse=function(d){this.$d=function(L){var g=L.date,w=L.utc;if(null===g)return new Date(NaN);if(S.u(g))return new Date;if(g instanceof Date)return new Date(g);if("string"==typeof g&&!/Z$/i.test(g)){var E=g.match(x);if(E){var D=E[2]-1||0,H=(E[7]||"0").substring(0,3);return w?new Date(Date.UTC(E[1],D,E[3]||1,E[4]||0,E[5]||0,E[6]||0,H)):new Date(E[1],D,E[3]||1,E[4]||0,E[5]||0,E[6]||0,H)}}return new Date(g)}(d),this.$x=d.x||{},this.init()},m.init=function(){var d=this.$d;this.$y=d.getFullYear(),this.$M=d.getMonth(),this.$D=d.getDate(),this.$W=d.getDay(),this.$H=d.getHours(),this.$m=d.getMinutes(),this.$s=d.getSeconds(),this.$ms=d.getMilliseconds()},m.$utils=function(){return S},m.isValid=function(){return this.$d.toString()!==r},m.isSame=function(d,L){var g=Z(d);return this.startOf(L)<=g&&g<=this.endOf(L)},m.isAfter=function(d,L){return Z(d)<this.startOf(L)},m.isBefore=function(d,L){return this.endOf(L)<Z(d)},m.$g=function(d,L,g){return S.u(d)?this[L]:this.set(g,d)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(d,L){var g=this,w=!!S.u(L)||L,E=S.p(d),D=function(j,Y){var W=S.w(g.$u?Date.UTC(g.$y,Y,j):new Date(g.$y,Y,j),g);return w?W:W.endOf(B)},H=function(j,Y){return S.w(g.toDate()[j].apply(g.toDate("s"),(w?[0,0,0,0]:[23,59,59,999]).slice(Y)),g)},N=this.$W,J=this.$M,G=this.$D,Q="set"+(this.$u?"UTC":"");switch(E){case p:return w?D(1,0):D(31,11);case o:return w?D(1,J):D(0,J+1);case l:var V=this.$locale().weekStart||0,K=(N<V?N+7:N)-V;return D(w?G-K:G+(6-K),J);case B:case u:return H(Q+"Hours",0);case b:return H(Q+"Minutes",1);case R:return H(Q+"Seconds",2);case e:return H(Q+"Milliseconds",3);default:return this.clone()}},m.endOf=function(d){return this.startOf(d,!1)},m.$set=function(d,L){var g,w=S.p(d),E="set"+(this.$u?"UTC":""),D=(g={},g[B]=E+"Date",g[u]=E+"Date",g[o]=E+"Month",g[p]=E+"FullYear",g[b]=E+"Hours",g[R]=E+"Minutes",g[e]=E+"Seconds",g[y]=E+"Milliseconds",g)[w],H=w===B?this.$D+(L-this.$W):L;if(w===o||w===p){var N=this.clone().set(u,1);N.$d[D](H),N.init(),this.$d=N.set(u,Math.min(this.$D,N.daysInMonth())).$d}else D&&this.$d[D](H);return this.init(),this},m.set=function(d,L){return this.clone().$set(d,L)},m.get=function(d){return this[S.p(d)]()},m.add=function(d,L){var g,w=this;d=Number(d);var E=S.p(L),D=function(J){var G=Z(w);return S.w(G.date(G.date()+Math.round(J*d)),w)};if(E===o)return this.set(o,this.$M+d);if(E===p)return this.set(p,this.$y+d);if(E===B)return D(1);if(E===l)return D(7);var H=(g={},g[R]=_,g[b]=c,g[e]=1e3,g)[E]||1,N=this.$d.getTime()+d*H;return S.w(N,this)},m.subtract=function(d,L){return this.add(-1*d,L)},m.format=function(d){var L=this,g=this.$locale();if(!this.isValid())return g.invalidDate||r;var w=d||"YYYY-MM-DDTHH:mm:ssZ",E=S.z(this),D=this.$H,H=this.$m,N=this.$M,J=g.weekdays,G=g.months,Q=function(Y,W,te,ee){return Y&&(Y[W]||Y(L,w))||te[W].slice(0,ee)},V=function(Y){return S.s(D%12||12,Y,"0")},K=g.meridiem||function(Y,W,te){var ee=Y<12?"AM":"PM";return te?ee.toLowerCase():ee},j={YY:String(this.$y).slice(-2),YYYY:this.$y,M:N+1,MM:S.s(N+1,2,"0"),MMM:Q(g.monthsShort,N,G,3),MMMM:Q(G,N),D:this.$D,DD:S.s(this.$D,2,"0"),d:String(this.$W),dd:Q(g.weekdaysMin,this.$W,J,2),ddd:Q(g.weekdaysShort,this.$W,J,3),dddd:J[this.$W],H:String(D),HH:S.s(D,2,"0"),h:V(1),hh:V(2),a:K(D,H,!0),A:K(D,H,!1),m:String(H),mm:S.s(H,2,"0"),s:String(this.$s),ss:S.s(this.$s,2,"0"),SSS:S.s(this.$ms,3,"0"),Z:E};return w.replace(A,function(Y,W){return W||j[Y]||E.replace(":","")})},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(d,L,g){var w,E=S.p(L),D=Z(d),H=(D.utcOffset()-this.utcOffset())*_,N=this-D,J=S.m(this,D);return J=(w={},w[p]=J/12,w[o]=J,w[a]=J/3,w[l]=(N-H)/6048e5,w[B]=(N-H)/864e5,w[b]=N/c,w[R]=N/_,w[e]=N/1e3,w)[E]||N,g?J:S.a(J)},m.daysInMonth=function(){return this.endOf(o).$D},m.$locale=function(){return M[this.$L]},m.locale=function(d,L){if(!d)return this.$L;var g=this.clone(),w=k(d,L,!0);return w&&(g.$L=w),g},m.clone=function(){return S.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},v}(),O=$.prototype;return Z.prototype=O,[["$ms",y],["$s",e],["$m",R],["$H",b],["$W",B],["$M",o],["$y",p],["$D",u]].forEach(function(v){O[v[1]]=function(m){return this.$g(m,v[0],v[1])}}),Z.extend=function(v,m){return v.$i||(v(m,$,Z),v.$i=!0),Z},Z.locale=k,Z.isDayjs=U,Z.unix=function(v){return Z(1e3*v)},Z.en=M[P],Z.Ls=M,Z.p={},Z}()},5268:function(z){z.exports=function(){"use strict";var q="minute",_=/[+-]\d\d(?::?\d\d)?/g,c=/([+-]|\d\d)/g;return function(y,e,R){var b=e.prototype;R.utc=function(r){return new e({date:r,utc:!0,args:arguments})},b.utc=function(r){var x=R(this.toDate(),{locale:this.$L,utc:!0});return r?x.add(this.utcOffset(),q):x},b.local=function(){return R(this.toDate(),{locale:this.$L,utc:!1})};var B=b.parse;b.parse=function(r){r.utc&&(this.$u=!0),this.$utils().u(r.$offset)||(this.$offset=r.$offset),B.call(this,r)};var l=b.init;b.init=function(){if(this.$u){var r=this.$d;this.$y=r.getUTCFullYear(),this.$M=r.getUTCMonth(),this.$D=r.getUTCDate(),this.$W=r.getUTCDay(),this.$H=r.getUTCHours(),this.$m=r.getUTCMinutes(),this.$s=r.getUTCSeconds(),this.$ms=r.getUTCMilliseconds()}else l.call(this)};var o=b.utcOffset;b.utcOffset=function(r,x){var A=this.$utils().u;if(A(r))return this.$u?0:A(this.$offset)?o.call(this):this.$offset;if("string"==typeof r&&null===(r=function(P){void 0===P&&(P="");var M=P.match(_);if(!M)return null;var U=(""+M[0]).match(c)||["-",0,0],Z=60*+U[1]+ +U[2];return 0===Z?0:"+"===U[0]?Z:-Z}(r)))return this;var f=Math.abs(r)<=16?60*r:r,T=this;if(x)return T.$offset=f,T.$u=0===r,T;if(0!==r){var C=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(T=this.local().add(f+C,q)).$offset=f,T.$x.$localOffset=C}else T=this.utc();return T};var a=b.format;b.format=function(r){return a.call(this,r||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":""))},b.valueOf=function(){var r=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*r},b.isUTC=function(){return!!this.$u},b.toISOString=function(){return this.toDate().toISOString()},b.toString=function(){return this.toDate().toUTCString()};var p=b.toDate;b.toDate=function(r){return"s"===r&&this.$offset?R(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():p.call(this)};var u=b.diff;b.diff=function(r,x,A){if(r&&this.$u===r.$u)return u.call(this,r,x,A);var f=this.local(),T=R(r).local();return u.call(f,T,x,A)}}}()}}]);